<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>monitoring on Админская фамилия</title><link>https://bubnovd.net/tags/monitoring/</link><description>Recent content in monitoring on Админская фамилия</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 27 May 2018 11:06:00 +0000</lastBuildDate><atom:link href="https://bubnovd.net/tags/monitoring/index.xml" rel="self" type="application/rss+xml"/><item><title>[Мониторинг] Prometheus + Grafana. Часть 1. Общая информация</title><link>https://bubnovd.net/blogger/%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3-prometheus--grafana.-%D1%87%D0%B0%D1%81%D1%82%D1%8C-1.-%D0%BE%D0%B1%D1%89%D0%B0%D1%8F-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F/</link><pubDate>Sun, 27 May 2018 11:06:00 +0000</pubDate><guid>https://bubnovd.net/blogger/%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3-prometheus--grafana.-%D1%87%D0%B0%D1%81%D1%82%D1%8C-1.-%D0%BE%D0%B1%D1%89%D0%B0%D1%8F-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F/</guid><description>Система мониторинга - неотъемлемая часть ИТ инфраструктуры. Сеть не исключение. Для мониторинга сети уже написано много различных систем на разные вкусы:
The Dude. Простая и быстрая в настройке и освоении система мониторинга от Mikrotik. Идеально подходит для небольших сетей или в случае, когда мониторинг нужен &amp;ldquo;вчера&amp;rdquo;
Zabbix. Монструозный гигант. Долгое время стандарт де факто в мониторинге (да и сейчас, пожалуй). Умеет, не побоюсь этого слова, всё. Cacti. Легковесная мониторилка на основе RRDTool</description><content>&lt;p>Система мониторинга - неотъемлемая часть ИТ инфраструктуры. Сеть не исключение. Для мониторинга сети уже написано много различных систем на разные вкусы:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="http://www.bubnovd.net/2017/05/thedudenetwork-managementandmonitoring.html">The Dude&lt;/a>. Простая и быстрая в настройке и освоении система мониторинга от Mikrotik. Идеально подходит для небольших сетей или в случае, когда мониторинг нужен &amp;ldquo;вчера&amp;rdquo;&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://www.zabbix.com/ru/">Zabbix&lt;/a>. Монструозный гигант. Долгое время стандарт де факто в мониторинге (да и сейчас, пожалуй). Умеет, не побоюсь этого слова, всё. &lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="http://www.bubnovd.net/2014/03/cacti-mikrotik-full-monitoring.html">Cacti&lt;/a>. Легковесная мониторилка на основе RRDTool&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://oss.oetiker.ch/mrtg/">MRTG&lt;/a>, &lt;a href="https://www.ru.paessler.com/prtg">PRTG&lt;/a> и &lt;a href="https://www.nagios.org/">куча&lt;/a> других &lt;a href="https://www.icinga.com/">систем&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>С распространением микросервисов функциональности и производительности существующих систем мониторинга стало не хватать и, что ожидаемо, начали разрабатываться и внедряться новые системы. В очередном моём проекте как раз понадобилась система мониторинга. И чтобы не отставать от цивилизованного мира, я решил попробовать что-то новое. Выбор пал на стек Prometheus + Grafana. Чтобы как-то увлечь Вас, предлагаю посмотреть на демо интерфейс по &lt;a href="https://play.grafana.org/d/000000003/big-dashboard?orgId=1">ссылке&lt;/a>.&lt;/p>
&lt;p>&lt;a href="https://3.bp.blogspot.com/-LyDAjmqZx7g/Wwrve4VCaXI/AAAAAAAAFP0/eicg99-DMPs07f5vrO_BbVTVzWEFRp_ZwCLcBGAs/s1600/grafana.PNG">&lt;img src="https://3.bp.blogspot.com/-LyDAjmqZx7g/Wwrve4VCaXI/AAAAAAAAFP0/eicg99-DMPs07f5vrO_BbVTVzWEFRp_ZwCLcBGAs/s640/grafana.PNG" alt="">&lt;/a>&lt;/p>
&lt;p>Grafana&lt;/p>
&lt;p>Давайте рассмотрим что же из себя представляет этот стек.&lt;/p>
&lt;p>В современной разработке принято разделять продукт на несколько разных по назначению частей. Так система получается более масштабируемой и универсальной. Вот и здесь система мониторинга состоит из нескольких частей:&lt;/p>
&lt;p>&lt;img src="https://avatars1.githubusercontent.com/u/3380462?s=200&amp;amp;v=4" alt="@prometheus">&lt;strong>&lt;a href="https://github.com/prometheus/prometheus">Prometheus&lt;/a>&lt;/strong>&lt;/p>
&lt;p>Как написано по ссылке, это система мониторинга и time-series database. Prometheus принимает метрики из разных источников (exporters), записывает их в базу и предоставляет интерфейс для построения графиков и различных выборок.&lt;/p>
&lt;p>&lt;img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIwLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIzNTFweCIgaGVpZ2h0PSIzNjVweCIgdmlld0JveD0iMCAwIDM1MSAzNjUiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDM1MSAzNjUiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8ZyBpZD0iTGF5ZXJfMV8xXyI+CjwvZz4KPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8xXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSIxNzAuOTE4MSIgeTE9IjQzOS40ODEiIHgyPSIxNzAuOTE4MSIgeTI9IjEwNi42NzQ5Ij4KCTxzdG9wICBvZmZzZXQ9IjAiIHN0eWxlPSJzdG9wLWNvbG9yOiNGRkYxMDAiLz4KCTxzdG9wICBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiNGMDVBMjgiLz4KPC9saW5lYXJHcmFkaWVudD4KPHBhdGggZmlsbD0idXJsKCNTVkdJRF8xXykiIGQ9Ik0zMzcuNSwxNjEuMWMtMC42LTYuMS0xLjYtMTMuMS0zLjYtMjAuOWMtMi03LjctNS0xNi4yLTkuNC0yNWMtNC40LTguOC0xMC4xLTE3LjktMTcuNS0yNi44CgljLTIuOS0zLjUtNi4xLTYuOS05LjUtMTAuMmM1LjEtMjAuMy02LjItMzcuOS02LjItMzcuOWMtMTkuNS0xLjItMzEuOSw2LjEtMzYuNSw5LjRjLTAuOC0wLjMtMS41LTAuNy0yLjMtMQoJYy0zLjMtMS4zLTYuNy0yLjYtMTAuMy0zLjdjLTMuNS0xLjEtNy4xLTIuMS0xMC44LTNjLTMuNy0wLjktNy40LTEuNi0xMS4yLTIuMmMtMC43LTAuMS0xLjMtMC4yLTItMC4zQzIwOS42LDEyLjQsMTg1LjEsMSwxODUuMSwxCgljLTI3LjMsMTcuMy0zMi40LDQxLjUtMzIuNCw0MS41cy0wLjEsMC41LTAuMywxLjRjLTEuNSwwLjQtMywwLjktNC41LDEuM2MtMi4xLDAuNi00LjIsMS40LTYuMiwyLjJjLTIuMSwwLjgtNC4xLDEuNi02LjIsMi41CgljLTQuMSwxLjgtOC4yLDMuOC0xMi4yLDZjLTMuOSwyLjItNy43LDQuNi0xMS40LDcuMWMtMC41LTAuMi0xLTAuNC0xLTAuNGMtMzcuOC0xNC40LTcxLjMsMi45LTcxLjMsMi45CgljLTMuMSw0MC4yLDE1LjEsNjUuNSwxOC43LDcwLjFjLTAuOSwyLjUtMS43LDUtMi41LDcuNWMtMi44LDkuMS00LjksMTguNC02LjIsMjguMWMtMC4yLDEuNC0wLjQsMi44LTAuNSw0LjIKCWMtMzQuOSwxNy4yLTQ1LjIsNTIuNS00NS4yLDUyLjVDMzMsMjYxLjQsNjcsMjYzLjUsNjcsMjYzLjVjMCwwLDAuMS0wLjEsMC4xLTAuMWM0LjMsNy43LDkuMywxNSwxNC45LDIxLjljMi40LDIuOSw0LjgsNS42LDcuNCw4LjMKCWMtMTAuNiwzMC40LDEuNSw1NS42LDEuNSw1NS42YzMyLjQsMS4yLDUzLjctMTQuMiw1OC4yLTE3LjdjMy4yLDEuMSw2LjUsMi4xLDkuOCwyLjljMTAsMi42LDIwLjIsNC4xLDMwLjQsNC41CgljMi41LDAuMSw1LjEsMC4yLDcuNiwwLjFsMS4yLDBsMC44LDBsMS42LDBsMS42LTAuMWMwLDAsMCwwLjEsMCwwLjFjMTUuMywyMS44LDQyLjEsMjQuOSw0Mi4xLDI0LjljMjEuNi0yMi44LDIwLjItNDUuMywyMC4yLTQ1LjMKCWMtMC4yLTAuMi0wLjQtMC4zLTAuNi0wLjVjNC4yLTIuOSw4LjItNi4xLDEyLTkuNWM3LjYtNi45LDE0LjMtMTQuOCwxOS45LTIzLjNjMC41LTAuOCwxLTEuNiwxLjUtMi40YzIxLjYsMS4yLDM2LjktMTMuNCwzNi45LTEzLjQKCWMtNC0yNS4yLTE5LjYtMzYtMTkuNi0zNmMtMC4yLDAtMC4zLDAuMS0wLjUsMC4xYzAuMi0xLjUsMC4zLTMsMC40LTQuNWMwLjItMi40LDAuMi00LjksMC4yLTcuM2wwLTEuOGwwLTAuOWwwLTAuNQoJYzAtMC42LDAtMC40LDAtMC42bC0wLjEtMS41bC0wLjEtMmMwLTAuNy0wLjEtMS4zLTAuMi0xLjljLTAuMS0wLjYtMC4xLTEuMy0wLjItMS45bC0wLjItMS45bC0wLjMtMS45Yy0wLjQtMi41LTAuOC00LjktMS40LTcuNAoJYy0yLjMtOS43LTYuMS0xOC45LTExLTI3LjJjLTUtOC4zLTExLjItMTUuNi0xOC4zLTIxLjhjLTctNi4yLTE0LjktMTEuMi0yMy4xLTE0LjljLTguMy0zLjctMTYuOS02LjEtMjUuNS03LjIKCWMtNC4zLTAuNi04LjYtMC44LTEyLjktMC43bC0xLjYsMGwtMC40LDBjLTAuMSwwLTAuNiwwLTAuNSwwbC0wLjcsMGwtMS42LDAuMWMtMC42LDAtMS4yLDAuMS0xLjcsMC4xYy0yLjIsMC4yLTQuNCwwLjUtNi41LDAuOQoJYy04LjYsMS42LTE2LjcsNC43LTIzLjgsOWMtNy4xLDQuMy0xMy4zLDkuNi0xOC4zLDE1LjZjLTUsNi04LjksMTIuNy0xMS42LDE5LjZjLTIuNyw2LjktNC4yLDE0LjEtNC42LDIxYy0wLjEsMS43LTAuMSwzLjUtMC4xLDUuMgoJYzAsMC40LDAsMC45LDAsMS4zbDAuMSwxLjRjMC4xLDAuOCwwLjEsMS43LDAuMiwyLjVjMC4zLDMuNSwxLDYuOSwxLjksMTAuMWMxLjksNi41LDQuOSwxMi40LDguNiwxNy40YzMuNyw1LDguMiw5LjEsMTIuOSwxMi40CgljNC43LDMuMiw5LjgsNS41LDE0LjgsN2M1LDEuNSwxMCwyLjEsMTQuNywyLjFjMC42LDAsMS4yLDAsMS43LDBjMC4zLDAsMC42LDAsMC45LDBjMC4zLDAsMC42LDAsMC45LTAuMWMwLjUsMCwxLTAuMSwxLjUtMC4xCgljMC4xLDAsMC4zLDAsMC40LTAuMWwwLjUtMC4xYzAuMywwLDAuNi0wLjEsMC45LTAuMWMwLjYtMC4xLDEuMS0wLjIsMS43LTAuM2MwLjYtMC4xLDEuMS0wLjIsMS42LTAuNGMxLjEtMC4yLDIuMS0wLjYsMy4xLTAuOQoJYzItMC43LDQtMS41LDUuNy0yLjRjMS44LTAuOSwzLjQtMiw1LTNjMC40LTAuMywwLjktMC42LDEuMy0xYzEuNi0xLjMsMS45LTMuNywwLjYtNS4zYy0xLjEtMS40LTMuMS0xLjgtNC43LTAuOQoJYy0wLjQsMC4yLTAuOCwwLjQtMS4yLDAuNmMtMS40LDAuNy0yLjgsMS4zLTQuMywxLjhjLTEuNSwwLjUtMy4xLDAuOS00LjcsMS4yYy0wLjgsMC4xLTEuNiwwLjItMi41LDAuM2MtMC40LDAtMC44LDAuMS0xLjMsMC4xCgljLTAuNCwwLTAuOSwwLTEuMiwwYy0wLjQsMC0wLjgsMC0xLjIsMGMtMC41LDAtMSwwLTEuNS0wLjFjMCwwLTAuMywwLTAuMSwwbC0wLjIsMGwtMC4zLDBjLTAuMiwwLTAuNSwwLTAuNy0wLjEKCWMtMC41LTAuMS0wLjktMC4xLTEuNC0wLjJjLTMuNy0wLjUtNy40LTEuNi0xMC45LTMuMmMtMy42LTEuNi03LTMuOC0xMC4xLTYuNmMtMy4xLTIuOC01LjgtNi4xLTcuOS05LjljLTIuMS0zLjgtMy42LTgtNC4zLTEyLjQKCWMtMC4zLTIuMi0wLjUtNC41LTAuNC02LjdjMC0wLjYsMC4xLTEuMiwwLjEtMS44YzAsMC4yLDAtMC4xLDAtMC4xbDAtMC4ybDAtMC41YzAtMC4zLDAuMS0wLjYsMC4xLTAuOWMwLjEtMS4yLDAuMy0yLjQsMC41LTMuNgoJYzEuNy05LjYsNi41LTE5LDEzLjktMjYuMWMxLjktMS44LDMuOS0zLjQsNi00LjljMi4xLTEuNSw0LjQtMi44LDYuOC0zLjljMi40LTEuMSw0LjgtMiw3LjQtMi43YzIuNS0wLjcsNS4xLTEuMSw3LjgtMS40CgljMS4zLTAuMSwyLjYtMC4yLDQtMC4yYzAuNCwwLDAuNiwwLDAuOSwwbDEuMSwwbDAuNywwYzAuMywwLDAsMCwwLjEsMGwwLjMsMGwxLjEsMC4xYzIuOSwwLjIsNS43LDAuNiw4LjUsMS4zCgljNS42LDEuMiwxMS4xLDMuMywxNi4yLDYuMWMxMC4yLDUuNywxOC45LDE0LjUsMjQuMiwyNS4xYzIuNyw1LjMsNC42LDExLDUuNSwxNi45YzAuMiwxLjUsMC40LDMsMC41LDQuNWwwLjEsMS4xbDAuMSwxLjEKCWMwLDAuNCwwLDAuOCwwLDEuMWMwLDAuNCwwLDAuOCwwLDEuMWwwLDFsMCwxLjFjMCwwLjctMC4xLDEuOS0wLjEsMi42Yy0wLjEsMS42LTAuMywzLjMtMC41LDQuOWMtMC4yLDEuNi0wLjUsMy4yLTAuOCw0LjgKCWMtMC4zLDEuNi0wLjcsMy4yLTEuMSw0LjdjLTAuOCwzLjEtMS44LDYuMi0zLDkuM2MtMi40LDYtNS42LDExLjgtOS40LDE3LjFjLTcuNywxMC42LTE4LjIsMTkuMi0zMC4yLDI0LjcKCWMtNiwyLjctMTIuMyw0LjctMTguOCw1LjdjLTMuMiwwLjYtNi41LDAuOS05LjgsMWwtMC42LDBsLTAuNSwwbC0xLjEsMGwtMS42LDBsLTAuOCwwYzAuNCwwLTAuMSwwLTAuMSwwbC0wLjMsMAoJYy0xLjgsMC0zLjUtMC4xLTUuMy0wLjNjLTctMC41LTEzLjktMS44LTIwLjctMy43Yy02LjctMS45LTEzLjItNC42LTE5LjQtNy44Yy0xMi4zLTYuNi0yMy40LTE1LjYtMzItMjYuNQoJYy00LjMtNS40LTguMS0xMS4zLTExLjItMTcuNGMtMy4xLTYuMS01LjYtMTIuNi03LjQtMTkuMWMtMS44LTYuNi0yLjktMTMuMy0zLjQtMjAuMWwtMC4xLTEuM2wwLTAuM2wwLTAuM2wwLTAuNmwwLTEuMWwwLTAuM2wwLTAuNAoJbDAtMC44bDAtMS42bDAtMC4zYzAsMCwwLDAuMSwwLTAuMWwwLTAuNmMwLTAuOCwwLTEuNywwLTIuNWMwLjEtMy4zLDAuNC02LjgsMC44LTEwLjJjMC40LTMuNCwxLTYuOSwxLjctMTAuMwoJYzAuNy0zLjQsMS41LTYuOCwyLjUtMTAuMmMxLjktNi43LDQuMy0xMy4yLDcuMS0xOS4zYzUuNy0xMi4yLDEzLjEtMjMuMSwyMi0zMS44YzIuMi0yLjIsNC41LTQuMiw2LjktNi4yYzIuNC0xLjksNC45LTMuNyw3LjUtNS40CgljMi41LTEuNyw1LjItMy4yLDcuOS00LjZjMS4zLTAuNywyLjctMS40LDQuMS0yYzAuNy0wLjMsMS40LTAuNiwyLjEtMC45YzAuNy0wLjMsMS40LTAuNiwyLjEtMC45YzIuOC0xLjIsNS43LTIuMiw4LjctMy4xCgljMC43LTAuMiwxLjUtMC40LDIuMi0wLjdjMC43LTAuMiwxLjUtMC40LDIuMi0wLjZjMS41LTAuNCwzLTAuOCw0LjUtMS4xYzAuNy0wLjIsMS41LTAuMywyLjMtMC41YzAuOC0wLjIsMS41LTAuMywyLjMtMC41CgljMC44LTAuMSwxLjUtMC4zLDIuMy0wLjRsMS4xLTAuMmwxLjItMC4yYzAuOC0wLjEsMS41LTAuMiwyLjMtMC4zYzAuOS0wLjEsMS43LTAuMiwyLjYtMC4zYzAuNy0wLjEsMS45LTAuMiwyLjYtMC4zCgljMC41LTAuMSwxLjEtMC4xLDEuNi0wLjJsMS4xLTAuMWwwLjUtMC4xbDAuNiwwYzAuOS0wLjEsMS43LTAuMSwyLjYtMC4ybDEuMy0wLjFjMCwwLDAuNSwwLDAuMSwwbDAuMywwbDAuNiwwCgljMC43LDAsMS41LTAuMSwyLjItMC4xYzIuOS0wLjEsNS45LTAuMSw4LjgsMGM1LjgsMC4yLDExLjUsMC45LDE3LDEuOWMxMS4xLDIuMSwyMS41LDUuNiwzMSwxMC4zYzkuNSw0LjYsMTcuOSwxMC4zLDI1LjMsMTYuNQoJYzAuNSwwLjQsMC45LDAuOCwxLjQsMS4yYzAuNCwwLjQsMC45LDAuOCwxLjMsMS4yYzAuOSwwLjgsMS43LDEuNiwyLjYsMi40YzAuOSwwLjgsMS43LDEuNiwyLjUsMi40YzAuOCwwLjgsMS42LDEuNiwyLjQsMi41CgljMy4xLDMuMyw2LDYuNiw4LjYsMTBjNS4yLDYuNyw5LjQsMTMuNSwxMi43LDE5LjljMC4yLDAuNCwwLjQsMC44LDAuNiwxLjJjMC4yLDAuNCwwLjQsMC44LDAuNiwxLjJjMC40LDAuOCwwLjgsMS42LDEuMSwyLjQKCWMwLjQsMC44LDAuNywxLjUsMS4xLDIuM2MwLjMsMC44LDAuNywxLjUsMSwyLjNjMS4yLDMsMi40LDUuOSwzLjMsOC42YzEuNSw0LjQsMi42LDguMywzLjUsMTEuN2MwLjMsMS40LDEuNiwyLjMsMywyLjEKCWMxLjUtMC4xLDIuNi0xLjMsMi42LTIuOEMzMzgsMTcwLjMsMzM3LjksMTY2LDMzNy41LDE2MS4xeiIvPgo8L3N2Zz4K" alt="Grafana Icon"> &lt;strong>&lt;a href="https://grafana.com/">Grafana&lt;/a>&lt;/strong>&lt;/p>
&lt;p>Если предыдущая часть собирает и хранит данные, то эта - отображает их в удобной для пользователя форме. Посмотрите ещё раз &lt;a href="https://play.grafana.org/d/000000012/grafana-play-home?orgId=1">на интерфейс&lt;/a> - ну разве не волшебство?&lt;/p>
&lt;p>Prometheus получает данные от экспортеров в виде простого текста. Вроде этого:&lt;/p>
&lt;blockquote>
&lt;p># HELP go_gc_duration_seconds A summary of the GC invocation durations.&lt;br>
# TYPE go_gc_duration_seconds summary&lt;br>
go_gc_duration_seconds{quantile=&amp;ldquo;0&amp;rdquo;} 6.5914e-05&lt;br>
go_gc_duration_seconds{quantile=&amp;ldquo;0.25&amp;rdquo;} 0.000120385&lt;br>
go_gc_duration_seconds{quantile=&amp;ldquo;0.5&amp;rdquo;} 0.000150536&lt;br>
go_gc_duration_seconds{quantile=&amp;ldquo;0.75&amp;rdquo;} 0.000208313&lt;br>
go_gc_duration_seconds{quantile=&amp;ldquo;1&amp;rdquo;} 0.001072873&lt;br>
go_gc_duration_seconds_sum 0.333397658&lt;br>
go_gc_duration_seconds_count 1648&lt;br>
# HELP go_goroutines Number of goroutines that currently exist.&lt;br>
# TYPE go_goroutines gauge&lt;br>
go_goroutines 58&lt;/p>
&lt;/blockquote>
&lt;p>Но эти данные ему ещё нужно доставить. Сами ведь они к нему не придут. Для этого существуют специальные модули, называемые exporters, которые позволяют отсылать данные Prometheus&amp;rsquo;у. Со списком можно ознакомиться &lt;a href="https://prometheus.io/docs/instrumenting/exporters/">по ссылке&lt;/a>. Это что-то вроде Zabbix agent&amp;rsquo;ов. Есть экспортеры для Linux и Windows, MS SQL, MySQL, Nginx и других систем.&lt;/p>
&lt;p>Так как нас в первую очередь интересует сеть, то и экспортировать нам надо SNMP. В этом нам поможет &lt;a href="https://github.com/prometheus/snmp_exporter">SNMP_exporter&lt;/a>.&lt;/p>
&lt;p>Таким образом, мы определились, что наш стек мониторинга будет работать на Prometheus, Grafana и snmp_exporter для Prometheus. Все эти модули можно менять на любые другие такого же назначения. Интерфейс Grafana можно заменить на Kibana (но не стоит этого делать - kibana совсем для других целей), а БД в виде Prometheus можно заменить на InfluxDB, Graphite или что-то ещё. Я выбрал именно Grafana + Prometheus + snmp_exporter за гибкий язык запросов prometheus  и гибкость и красоту grafana.&lt;/p>
&lt;p>Чтобы ещё больше погрузиться в модные технологии, весь стек было решено поднимать в docker контейнерах. Вам совсем необязательно повторять этот трюк, но познакомиться с контейнерезацией в XXI веке тоже было бы неплохо.&lt;/p>
&lt;p>На этом пока всё. В следующей части установим и настроим сборку метрик с помощью prometheus и snmp_exporter.&lt;/p></content></item><item><title>SMS оповещения из The Dude</title><link>https://bubnovd.net/blogger/sms-%D0%BE%D0%BF%D0%BE%D0%B2%D0%B5%D1%89%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B8%D0%B7-the-dude/</link><pubDate>Tue, 07 Apr 2015 21:32:00 +0000</pubDate><guid>https://bubnovd.net/blogger/sms-%D0%BE%D0%BF%D0%BE%D0%B2%D0%B5%D1%89%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B8%D0%B7-the-dude/</guid><description>Какой смысл в мониторинге ключевых устройств, если об их некорректной работе будет знать только сама система мониторинга? Именно поэтому система мониторинга должна оповещать админа о некорректной работе. Я работаю Mikrotik&amp;rsquo;ами, поэтому использую фирменную систему мониторинга The Dude. И сейчас мы научим её слать почту и смс.По умолчанию The Dude умеет отправлять email, но для этого ей нужен SMTP сервер без авторизации. Что нам поднимать конечно же не имеет смысла. В общем, разработчики поленились сделать кошерно.</description><content>&lt;p>Какой смысл в мониторинге ключевых устройств, если об их некорректной работе будет знать только сама система мониторинга? Именно поэтому система мониторинга должна оповещать админа о некорректной работе. Я работаю Mikrotik&amp;rsquo;ами, поэтому использую фирменную систему мониторинга The Dude. И сейчас мы научим её слать почту и смс.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->По умолчанию The Dude умеет отправлять email, но для этого ей нужен SMTP сервер без авторизации. Что нам поднимать конечно же не имеет смысла. В общем, разработчики поленились сделать кошерно.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Пытливые умы же научились отправлять почту сторонним приложением.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Качаем SMTP-клиент &lt;!-- raw HTML omitted -->mailsend&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Кладем его, допустим, сюда &lt;!-- raw HTML omitted -->C:\Program Files (x86)\Dude\mailsend\mailsend.exe&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->(не забудьте переименовать экзешник)&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Создаём файлик mailsend.cmd следующего содержания: &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->:: Send email notifications from Dude via Gmail&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->:: &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set mailsenderdir=C:\Program Files (x86)\Dude\mailsend&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set mailsender=mailsend.exe&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set &lt;a href="mailto:smtpsender=username@gmail.com">smtpsender=username@gmail.com&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set smtpsenderfullname=username&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set smtpserver=smtp.gmail.com&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set smtpport=465&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set &lt;a href="mailto:smtpuser=username@gmail.com">smtpuser=username@gmail.com&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set smtppwd=password&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set &lt;a href="mailto:mailto=username@gmail.com">mailto=username@gmail.com&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->::&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->::&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;quot;%mailsenderdir%%mailsender%&amp;quot; -smtp %smtpserver% -port %smtpport% -ssl -auth -user %smtpuser% -pass %smtppwd% -t %mailto% -f %smtpsender% -name &amp;ldquo;%smtpsenderfullname%&amp;rdquo; +cc +bc -q -sub %1 -M %2&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->::&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->::pause&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->::&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Эти параметры меняем на свои: &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->smtpsender - ящик, с которого будут отправляться письма&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->smtpsenderfullname - имя пользователя этого ящика&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->smtpuser - опять ящик&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->smtppwd - пароль к нему&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->mailto - ящик админа (на который будем слать алерты)&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->4. Создаем новое уведомление в The Dude:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Имя: mail&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Тип: execute on server&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Команда: &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;ldquo;C:\Program Files (x86)\Dude\mailsend\mailsend.cmd&amp;rdquo; &amp;ldquo;Service [Probe.Name] on [Device.Name] is now [Service.Status]&amp;rdquo; &amp;ldquo;Service [Probe.Name] on [Device.Name] is now [Service.Status] ([Service.ProblemDescription])&amp;quot;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->После нажатия кнопки Test письмо должно упасть на почту.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->С почтой разобрались. Теперь нужно научить Дудку отправлять СМС. Саму мониторилку мы больше мучать не будем - СМС умеет отправлять гуглопочта.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Итак, что нужно для начала: у вас должен быть привязан телефонный номер к Google Calendar, как это сделать написано вот тут — Регистрация мобильного телефона:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->support.google.com/calendar/bin/answer.py?hl=ru&amp;amp;hlrm=en&amp;amp;answer=45351&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Создайте новый ярлык в Gmail с именем, например, SMSnotify (или любым другим, по вашему усмотрению). Как это сделать написано вот тут – Использование ярлыков:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->support.google.com/mail/bin/answer.py?hl=ru&amp;amp;hlrm=ru&amp;amp;answer=118708#0&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Создайте фильтр, который будет применять ярлык SMSnotify к письмам от системы мониторинга ( From: &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;a href="mailto:username@gmail.com">username@gmail.com&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->). Как это сделать, написано вот тут – Использование фильтров:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->support.google.com/mail/bin/answer.py?hl=ru&amp;amp;hlrm=ru&amp;amp;answer=6579#0&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Войдите в Google Drive и создайте новую электронную таблицу (Spreadsheet). Откройте созданную таблицу и в верхнем меню выберите Tools &amp;gt; Script Editor.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Нужно создать доп. календарь и настроить SMS уведомления: установить по-умолчанию для всех новых встреч вот так:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Настройки-&amp;gt;Календари-&amp;gt;Уведомления-&amp;gt;По умолчанию-&amp;gt;SMS-&amp;gt;%% мин&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->В этом примере имя календаря будет &amp;ldquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->email&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;quot;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Вставляем следующий код:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->function my_notification() { &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->var&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> calendar = CalendarApp.getOwnedCalendarsByName(&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;lsquo;email&amp;rsquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->)[&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->0&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->]; &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->//открываем календарь с именем &amp;ldquo;email&amp;rdquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->var&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> threads = GmailApp.getUserLabelByName(&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;lsquo;SMSnotify&amp;rsquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->).getThreads(); &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->//переменная, в которой хранится коллекция цепочек с ярлыком SMSnotify&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->var&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> now = &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->new&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> Date(); &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->if&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->(threads == &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->0&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->) &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->return&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->; &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->// прекращение выполнения, если новых цепочек нет&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->for&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->(i &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->in&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> threads) &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->// создаем события&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> { calendar.createEvent(threads[i].getFirstMessageSubject(), &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->new&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> Date(now.getTime()+&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->60000&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->), &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->new&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> Date(now.getTime()+&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->60000&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->)); } GmailApp.getUserLabelByName(&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;lsquo;SMSnotify&amp;rsquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->).removeFromThreads(threads); &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->//снимаем метки &amp;ldquo;SMSnotify&amp;rdquo; с цепочек&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->}&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->6.&lt;!-- raw HTML omitted -->  &lt;!-- raw HTML omitted -->После того, как вы ввели код, нужно создать триггер по которому и будет запускаться скрипт. Для этого кликаем на меню &amp;ldquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Ресурсы&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;rdquo;, а в нем на &amp;ldquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Триггеры текущего скрипта&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;rdquo;. &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->7.  &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Нам нужен&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> time-driven &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->триггер с частотой повторения одна минута.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Этот скрипт будет проверять входящие от с ярлыком &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->SMSnotify&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> (от юзера &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;a href="mailto:username@gmail.com">username@gmail.com&lt;/a>). И, в случае наличия новых писем создавать событие в календаре и снимать ярлык с уже обработанного письма. СМС будет слать сам календарь.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Статья написана методом копипаста! Навеяно этим: &lt;!-- raw HTML omitted -->отправка email уведомлений&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->отправка СМС из гуглопочты&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;/p></content></item><item><title>Cacti + Mikrotik = Full Monitoring</title><link>https://bubnovd.net/blogger/cacti--mikrotik--full-monitoring/</link><pubDate>Sat, 01 Mar 2014 02:21:00 +0000</pubDate><guid>https://bubnovd.net/blogger/cacti--mikrotik--full-monitoring/</guid><description>Захотелось мне собирать все логи с сетевого оборудования в одном месте. Решил поднять syslog-сервер. Так как с такими сервисами никогда не сталкивался, пришлось спросить у великого гугля. Он подсказал мне, что с этим неплохо справляется система мониторинга Cacti. А о ней то я уже наслышан, и в планах стояло внедрение сего чуда в сеть. Итак, теперь основная цель не сислог, а мониторинг - то, для чего и создан cacti. Настроим мониторинг, а потом примемся за сислог.</description><content>&lt;p>Захотелось мне собирать все логи с сетевого оборудования в одном месте. Решил поднять syslog-сервер. Так как с такими сервисами никогда не сталкивался, пришлось спросить у великого гугля. Он подсказал мне, что с этим неплохо справляется система мониторинга Cacti. А о ней то я уже наслышан, и в планах стояло внедрение сего чуда в сеть. Итак, теперь основная цель не сислог, а мониторинг - то, для чего и создан cacti. Настроим мониторинг, а потом примемся за сислог.&lt;/p>
&lt;p>Система мониторинга Cacti разрабатывалась с целью визуализации данных, поэтому сравнивать её с другими будет несколько неуместно. Я для мониторинга активности устройств использую The Dude. И советую её всем, у кого сеть построена на микротиках, т.к. разработана она этой компанией, и, соответственно, умеет полностью управлять Mikrotik&amp;rsquo;ом. Но об этом в следующей статье.&lt;/p>
&lt;p>Итак, cacti можно установить на Windows и UNIX-like системы. Для работы ей нужны:&lt;/p>
&lt;ol>
&lt;li>web-server (apache 2.2)&lt;/li>
&lt;li>database server (mySQL 5.6)&lt;/li>
&lt;li>php (php 5.4)&lt;/li>
&lt;li>RRDTool (1.4.8)&lt;/li>
&lt;li>net-snmp (5.7)&lt;/li>
&lt;/ol>
&lt;p>В скобках указаны версии, установленные мной на FreeBSD 10.0 (запущенной под Hyper-V в Windows 2012). Процесс установки подробно расписывать не буду. Я руководствовался этими ресурсами:&lt;/p>
&lt;ol>
&lt;li>&lt;a href="http://nix-sa.blogspot.ru/2011/08/cacti.html">Установка Cacti (краткая заметка)&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://habrahabr.ru/post/71087/">Кактус у монитора или ускоренная установка cacti&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://samag.ru/archive/article/1770">Cacti – простой и удобный инструмент для мониторинга и анализа сети&lt;/a> &lt;/li>
&lt;/ol>
&lt;p> Я давно не работал с UNIX-like системами, поэтому возникли некоторые проблемы (будьте осторожны выбирая пакеты, которые тянет php. Он может вытянуть иксы). Для тех, кто впервые ставит LAMP, советую почитать мануалы по установке и конфигурированию сервисов.&lt;/p>
&lt;p>Ставим &lt;a href="http://docs.cacti.net/plugin:mikrotik">плагин&lt;/a> для работы с Mikrotik (копируем папку в /usr/share/local/cacti/plugins и идем в веб-интерфейсе кактуса в Configuration - Plugin Management и нажимаем Install, Activate). При его установке выпадает ошибка. Лечится удалением строки &amp;lsquo;Invalid round robin archive&amp;rsquo; из /usr/local/share/cacti/plugins/mikrotik/templates/cacti_host_template_mikrotik_device.xml.&lt;/p>
&lt;p>Настраиваем SNMP на Mikrotik. IP -&amp;gt; SNMP -&amp;gt; Communities. Использовать стандартный public не рекомендую, т.к. он передаёт данные в открытом виде и без авторизации. Мы будем использовать SNMP v3, поддерживающий авторизацию и шифрование. Добавляем новую community:&lt;/p>
&lt;ul>
&lt;li>имя - любое (cacti)&lt;/li>
&lt;li>Addresses - адрес сервера SNMP (на котором стоит cacti)&lt;/li>
&lt;li>Security - authorized&lt;/li>
&lt;li>Read/write - выбираем по своему усмотрению, read нужен обязательно, а write только если планируем конфигурировать роутер по SNMP протоколу&lt;/li>
&lt;li>Протоколы авторизации и шифрования оставляем дефолтные&lt;/li>
&lt;li>Задаём пароль авторизации и парольную фразу для шифрования (могут быть разные значения)&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="http://3.bp.blogspot.com/-qeSZdaw9AGc/UxGx8cC4McI/AAAAAAAAAe0/Ck3khsntuKo/s1600/mt-snmp.png">&lt;img src="http://3.bp.blogspot.com/-qeSZdaw9AGc/UxGx8cC4McI/AAAAAAAAAe0/Ck3khsntuKo/s1600/mt-snmp.png" alt="">&lt;/a>&lt;/p>
&lt;p>В SNMP Settings пишем:&lt;/p>
&lt;ul>
&lt;li>Contact Info - почта админа&lt;/li>
&lt;li>Location - физическое расположение устройства&lt;/li>
&lt;li>Trap Target - адрес SNMP сервера&lt;/li>
&lt;li>Выбираем созданную нами Trap Community&lt;/li>
&lt;li>Trap Version - 3&lt;/li>
&lt;li>Trap Generation - кто будет генерировать сообщения для сервера - интерфейс или встроенный сервер&lt;/li>
&lt;li>Выбираем нужные интерфейсы&lt;/li>
&lt;/ul>
&lt;p>Добавляем в cacti наш микротик. Подробно распишу только про SNMP options:&lt;/p>
&lt;ul>
&lt;li>SNMP Version - 3&lt;/li>
&lt;li>SNMP Username (v3) -  имя нашего Community (cacti)&lt;/li>
&lt;li>SNMP Password (v3) - то, что ввели в Authentication Password в Mikrotik&lt;/li>
&lt;li>SNMP Privacy Passphrase (v3) - Encryption Password в Mikrotik&lt;/li>
&lt;/ul>
&lt;p>По дальнейшей работе с кактусом полно мануалов. Также есть отличная документация на оф. сайте, правда на английском. &lt;a href="http://mum.mikrotik.com/presentations/CZ09/schaub.pdf">Презентация&lt;/a> о настройке SNMP на Mikrotik.&lt;/p>
&lt;p>Первый час работы кактуса:&lt;/p>
&lt;p>&lt;a href="http://2.bp.blogspot.com/-Nmv5KEBWAUs/UxG0IYWDldI/AAAAAAAAAfA/rGKLw1ncLhA/s1600/Screenshot+from+2014-03-01+16:18:55.png">&lt;img src="http://2.bp.blogspot.com/-Nmv5KEBWAUs/UxG0IYWDldI/AAAAAAAAAfA/rGKLw1ncLhA/s1600/Screenshot+from+2014-03-01+16:18:55.png" alt="">&lt;/a>&lt;/p>
&lt;p>За сим откланяюсь. Постараюсь сочинить что-нибудь про The Dude. Да и про кактус, когда сам в нем разберусь.&lt;/p></content></item><item><title>Система мониторинга Zabbix. Кратко об установке и первичной настройке.</title><link>https://bubnovd.net/blogger/%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0-%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3%D0%B0-zabbix.-%D0%BA%D1%80%D0%B0%D1%82%D0%BA%D0%BE-%D0%BE%D0%B1-%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B5-%D0%B8-%D0%BF%D0%B5%D1%80%D0%B2%D0%B8%D1%87%D0%BD%D0%BE%D0%B9-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B5./</link><pubDate>Fri, 15 Apr 2011 01:50:00 +0000</pubDate><guid>https://bubnovd.net/blogger/%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0-%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3%D0%B0-zabbix.-%D0%BA%D1%80%D0%B0%D1%82%D0%BA%D0%BE-%D0%BE%D0%B1-%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B5-%D0%B8-%D0%BF%D0%B5%D1%80%D0%B2%D0%B8%D1%87%D0%BD%D0%BE%D0%B9-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B5./</guid><description>Zabbix - система для мониторинга состояния сетей, включая рабочие станции, сервера, маршрутизаторы, коммутаторы и т.д. Серверная часть работает на UNIX-подобных ОС. Данные о работе устройств собираются посредством протокола SNMP, системы IPMI и Zabbix-агента. Клинтская часть работает на всех распространенных ОС. Установка серверной частиЧасть взята отсюда: http://wiki.enchtex.info/howto/zabbix/zabbix-ubuntu-8.04sudo apt-get install zabbix-server-mysql zabbix-agent zabbix-frontend-phpЕсли MySQL уже установлена, то необходимо ввести пароль администратора БД. Иначе - задать новый пароль для администратора БД. Все настройки хранятся в /etc/zabbix.</description><content>&lt;p>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Zabbix - система для мониторинга состояния сетей, включая рабочие станции, сервера, маршрутизаторы, коммутаторы и т.д. Серверная часть работает на UNIX-подобных ОС. Данные о работе устройств собираются посредством протокола SNMP, системы IPMI и Zabbix-агента. Клинтская часть работает на всех распространенных ОС.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> Установка серверной части&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Часть взята отсюда: &lt;!-- raw HTML omitted -->&lt;a href="http://wiki.enchtex.info/howto/zabbix/zabbix-ubuntu-8.04">http://wiki.enchtex.info/howto/zabbix/zabbix-ubuntu-8.04&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->sudo apt-get install zabbix-server-mysql zabbix-agent zabbix-frontend-php&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Если MySQL уже установлена, то необходимо ввести пароль администратора БД. Иначе - задать новый пароль для администратора БД. Все настройки хранятся в /etc/zabbix.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->После установки открываем в браузере http://serverIP/zabbix. По умолчанию логин Admin, без пароля. Для Ubuntu 10.xx и выше логин/пароль admin/zabbix. Если веб-интерфейс выдает предупреждение: &amp;ldquo;Timezone for PHP is not set. Please set &amp;ldquo;date.timezone&amp;rdquo; option in php.ini.&amp;rdquo;, то в /etc/php5/apache2/php.ini следует указать часовой пояс &amp;ldquo;date.timezone = Asia/Yekaterinburg&amp;rdquo; (nano /etc/php5/apache/php.ini) и перезапустить apache: /etc/init.d/apache2 restart. Если всплывает ещё одно предупреждение &amp;ldquo;PHP max execution time: 30 sec Fail&amp;rdquo;, то в том же файле указываем время выполнения скриптов 300 сек. &amp;ldquo;max_execution_time = 300&amp;rdquo; и снова перезапускаем веб-сервер. Далее заходим в меню - Administration -&amp;gt; Installation жмем Next, соглашаемся с условиями лицензии и проверяем рекомендуемые настройки. Если строчка выделена красным, значит следует изменить соответствующее значение в указанном выше php.ini на рекомендуемое (указано в столбце Recommended). Дальше проверяем соединение с БД (необходимо ввести пароль администратора БД, который вводили при установке).&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Если что-то не получается необходимо выполнить следующие действия:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Проверить файл /etc/zabbix/dbconfig.php. В нем должны быть указаны правильные учетные данные и IP сервера (локальный 192.168.0.1).&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->В файле /etc/zabbix/zabbix-server.conf все настройки оставляем по умолчанию, за исключением адреса сервера. Его ставим таким же как и dbconfig.php. Строка FpingLocation по умолчанию указывает в неверную для Ubuntu директорию. Указываем /usr/bin/fping.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->В файле zabbix_agent.conf указываем IP нашего сервера (server = 192.168.0.1) и отображаемое в Zabbix имя хоста (Hostname = zabbix_client1). Остальные параметры не меняем.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> Установка клиентской части на Windows&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Отсюда &lt;!-- raw HTML omitted -->&lt;a href="http://www.zabbix.com/ru/download.php">http://www.zabbix.com/ru/download.php&lt;/a>&lt;!-- raw HTML omitted --> скачиваем zabbix-агент для нашей ОС.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Копируем /etc/zabbix/zabbix_agentd.conf с сервера на клиент (в C:\program files\zabbix). Меняем в нем имя хоста. Можно также поменять уровень логирования (DebugLevel = 4), на случай если агент не сможет подключиться к серверу в C:\program files\zabbix\zabbix_agentd.log можно будет увидеть подробный отчет о работе агента.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Агент устанавливается в качестве службы. Для установки следует запустить командную строку с правами администратора, перейти в папку с zabbix-агентом и выполнить zabbix_agentd.exe -i -c &amp;ldquo;C:\program files\zabbix\zabbix_agentd.conf&amp;rdquo;. Служба автоматически не запускается, поэтому следует запустить её из оснастки &amp;ldquo;Управление компьютером&amp;rdquo;.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Фаервол должен пропускать трафик на порту 10050.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> Добавление хостов&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->В веб-интерфейсе Zabbix открываем в меню Configuration -&amp;gt; Hosts. Жмём Create Host. Вводим имя хоста, его группу, IP-адрес и устанавливаем статус monitored. В правой части в панели Linked Templates жмём Add и выбираем тип хоста (в нашем случае Template Windows, вверху в группах необходимо выбрать Templates)&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Для проверки корректности подключения клиентов можно в консоли сервера выполнить команду zabbix_get -s %client-IP% -k system.uname В ответ должны получить название ОС.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->UPD 02.08.11&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Новый пост на хабре про Zabbix: &lt;!-- raw HTML omitted -->&lt;a href="http://habrahabr.ru/blogs/sysadm/125340/">http://habrahabr.ru/blogs/sysadm/125340/&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;/p></content></item></channel></rss>