<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>оповещения on Админская фамилия</title><link>https://bubnovd.net/tags/%D0%BE%D0%BF%D0%BE%D0%B2%D0%B5%D1%89%D0%B5%D0%BD%D0%B8%D1%8F/</link><description>Recent content in оповещения on Админская фамилия</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 07 Apr 2015 21:32:00 +0000</lastBuildDate><atom:link href="https://bubnovd.net/tags/%D0%BE%D0%BF%D0%BE%D0%B2%D0%B5%D1%89%D0%B5%D0%BD%D0%B8%D1%8F/index.xml" rel="self" type="application/rss+xml"/><item><title>SMS оповещения из The Dude</title><link>https://bubnovd.net/blogger/sms-%D0%BE%D0%BF%D0%BE%D0%B2%D0%B5%D1%89%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B8%D0%B7-the-dude/</link><pubDate>Tue, 07 Apr 2015 21:32:00 +0000</pubDate><guid>https://bubnovd.net/blogger/sms-%D0%BE%D0%BF%D0%BE%D0%B2%D0%B5%D1%89%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B8%D0%B7-the-dude/</guid><description>Какой смысл в мониторинге ключевых устройств, если об их некорректной работе будет знать только сама система мониторинга? Именно поэтому система мониторинга должна оповещать админа о некорректной работе. Я работаю Mikrotik&amp;rsquo;ами, поэтому использую фирменную систему мониторинга The Dude. И сейчас мы научим её слать почту и смс.По умолчанию The Dude умеет отправлять email, но для этого ей нужен SMTP сервер без авторизации. Что нам поднимать конечно же не имеет смысла. В общем, разработчики поленились сделать кошерно.</description><content>&lt;p>Какой смысл в мониторинге ключевых устройств, если об их некорректной работе будет знать только сама система мониторинга? Именно поэтому система мониторинга должна оповещать админа о некорректной работе. Я работаю Mikrotik&amp;rsquo;ами, поэтому использую фирменную систему мониторинга The Dude. И сейчас мы научим её слать почту и смс.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->По умолчанию The Dude умеет отправлять email, но для этого ей нужен SMTP сервер без авторизации. Что нам поднимать конечно же не имеет смысла. В общем, разработчики поленились сделать кошерно.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Пытливые умы же научились отправлять почту сторонним приложением.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Качаем SMTP-клиент &lt;!-- raw HTML omitted -->mailsend&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Кладем его, допустим, сюда &lt;!-- raw HTML omitted -->C:\Program Files (x86)\Dude\mailsend\mailsend.exe&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->(не забудьте переименовать экзешник)&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Создаём файлик mailsend.cmd следующего содержания: &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->:: Send email notifications from Dude via Gmail&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->:: &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set mailsenderdir=C:\Program Files (x86)\Dude\mailsend&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set mailsender=mailsend.exe&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set &lt;a href="mailto:smtpsender=username@gmail.com">smtpsender=username@gmail.com&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set smtpsenderfullname=username&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set smtpserver=smtp.gmail.com&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set smtpport=465&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set &lt;a href="mailto:smtpuser=username@gmail.com">smtpuser=username@gmail.com&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set smtppwd=password&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->set &lt;a href="mailto:mailto=username@gmail.com">mailto=username@gmail.com&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->::&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->::&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;quot;%mailsenderdir%%mailsender%&amp;quot; -smtp %smtpserver% -port %smtpport% -ssl -auth -user %smtpuser% -pass %smtppwd% -t %mailto% -f %smtpsender% -name &amp;ldquo;%smtpsenderfullname%&amp;rdquo; +cc +bc -q -sub %1 -M %2&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->::&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->::pause&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->::&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Эти параметры меняем на свои: &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->smtpsender - ящик, с которого будут отправляться письма&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->smtpsenderfullname - имя пользователя этого ящика&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->smtpuser - опять ящик&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->smtppwd - пароль к нему&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->mailto - ящик админа (на который будем слать алерты)&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->4. Создаем новое уведомление в The Dude:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Имя: mail&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Тип: execute on server&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Команда: &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;ldquo;C:\Program Files (x86)\Dude\mailsend\mailsend.cmd&amp;rdquo; &amp;ldquo;Service [Probe.Name] on [Device.Name] is now [Service.Status]&amp;rdquo; &amp;ldquo;Service [Probe.Name] on [Device.Name] is now [Service.Status] ([Service.ProblemDescription])&amp;quot;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->После нажатия кнопки Test письмо должно упасть на почту.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->С почтой разобрались. Теперь нужно научить Дудку отправлять СМС. Саму мониторилку мы больше мучать не будем - СМС умеет отправлять гуглопочта.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Итак, что нужно для начала: у вас должен быть привязан телефонный номер к Google Calendar, как это сделать написано вот тут — Регистрация мобильного телефона:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->support.google.com/calendar/bin/answer.py?hl=ru&amp;amp;hlrm=en&amp;amp;answer=45351&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Создайте новый ярлык в Gmail с именем, например, SMSnotify (или любым другим, по вашему усмотрению). Как это сделать написано вот тут – Использование ярлыков:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->support.google.com/mail/bin/answer.py?hl=ru&amp;amp;hlrm=ru&amp;amp;answer=118708#0&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Создайте фильтр, который будет применять ярлык SMSnotify к письмам от системы мониторинга ( From: &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;a href="mailto:username@gmail.com">username@gmail.com&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->). Как это сделать, написано вот тут – Использование фильтров:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->support.google.com/mail/bin/answer.py?hl=ru&amp;amp;hlrm=ru&amp;amp;answer=6579#0&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Войдите в Google Drive и создайте новую электронную таблицу (Spreadsheet). Откройте созданную таблицу и в верхнем меню выберите Tools &amp;gt; Script Editor.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Нужно создать доп. календарь и настроить SMS уведомления: установить по-умолчанию для всех новых встреч вот так:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Настройки-&amp;gt;Календари-&amp;gt;Уведомления-&amp;gt;По умолчанию-&amp;gt;SMS-&amp;gt;%% мин&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->В этом примере имя календаря будет &amp;ldquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->email&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;quot;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Вставляем следующий код:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->function my_notification() { &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->var&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> calendar = CalendarApp.getOwnedCalendarsByName(&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;lsquo;email&amp;rsquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->)[&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->0&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->]; &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->//открываем календарь с именем &amp;ldquo;email&amp;rdquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->var&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> threads = GmailApp.getUserLabelByName(&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;lsquo;SMSnotify&amp;rsquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->).getThreads(); &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->//переменная, в которой хранится коллекция цепочек с ярлыком SMSnotify&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->var&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> now = &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->new&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> Date(); &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->if&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->(threads == &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->0&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->) &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->return&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->; &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->// прекращение выполнения, если новых цепочек нет&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->for&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->(i &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->in&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> threads) &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->// создаем события&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> { calendar.createEvent(threads[i].getFirstMessageSubject(), &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->new&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> Date(now.getTime()+&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->60000&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->), &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->new&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> Date(now.getTime()+&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->60000&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->)); } GmailApp.getUserLabelByName(&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;lsquo;SMSnotify&amp;rsquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->).removeFromThreads(threads); &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->//снимаем метки &amp;ldquo;SMSnotify&amp;rdquo; с цепочек&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->}&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->6.&lt;!-- raw HTML omitted -->  &lt;!-- raw HTML omitted -->После того, как вы ввели код, нужно создать триггер по которому и будет запускаться скрипт. Для этого кликаем на меню &amp;ldquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Ресурсы&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;rdquo;, а в нем на &amp;ldquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Триггеры текущего скрипта&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&amp;rdquo;. &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->7.  &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Нам нужен&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> time-driven &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->триггер с частотой повторения одна минута.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Этот скрипт будет проверять входящие от с ярлыком &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->SMSnotify&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> (от юзера &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;a href="mailto:username@gmail.com">username@gmail.com&lt;/a>). И, в случае наличия новых писем создавать событие в календаре и снимать ярлык с уже обработанного письма. СМС будет слать сам календарь.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Статья написана методом копипаста! Навеяно этим: &lt;!-- raw HTML omitted -->отправка email уведомлений&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->отправка СМС из гуглопочты&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;/p></content></item></channel></rss>