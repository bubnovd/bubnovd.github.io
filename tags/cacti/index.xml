<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>cacti on Админская фамилия</title><link>https://bubnovd.net/tags/cacti/</link><description>Recent content in cacti on Админская фамилия</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 01 Mar 2014 02:21:00 +0000</lastBuildDate><atom:link href="https://bubnovd.net/tags/cacti/index.xml" rel="self" type="application/rss+xml"/><item><title>Cacti + Mikrotik = Full Monitoring</title><link>https://bubnovd.net/blogger/cacti--mikrotik--full-monitoring/</link><pubDate>Sat, 01 Mar 2014 02:21:00 +0000</pubDate><guid>https://bubnovd.net/blogger/cacti--mikrotik--full-monitoring/</guid><description>Захотелось мне собирать все логи с сетевого оборудования в одном месте. Решил поднять syslog-сервер. Так как с такими сервисами никогда не сталкивался, пришлось спросить у великого гугля. Он подсказал мне, что с этим неплохо справляется система мониторинга Cacti. А о ней то я уже наслышан, и в планах стояло внедрение сего чуда в сеть. Итак, теперь основная цель не сислог, а мониторинг - то, для чего и создан cacti. Настроим мониторинг, а потом примемся за сислог.</description><content>&lt;p>Захотелось мне собирать все логи с сетевого оборудования в одном месте. Решил поднять syslog-сервер. Так как с такими сервисами никогда не сталкивался, пришлось спросить у великого гугля. Он подсказал мне, что с этим неплохо справляется система мониторинга Cacti. А о ней то я уже наслышан, и в планах стояло внедрение сего чуда в сеть. Итак, теперь основная цель не сислог, а мониторинг - то, для чего и создан cacti. Настроим мониторинг, а потом примемся за сислог.&lt;/p>
&lt;p>Система мониторинга Cacti разрабатывалась с целью визуализации данных, поэтому сравнивать её с другими будет несколько неуместно. Я для мониторинга активности устройств использую The Dude. И советую её всем, у кого сеть построена на микротиках, т.к. разработана она этой компанией, и, соответственно, умеет полностью управлять Mikrotik&amp;rsquo;ом. Но об этом в следующей статье.&lt;/p>
&lt;p>Итак, cacti можно установить на Windows и UNIX-like системы. Для работы ей нужны:&lt;/p>
&lt;ol>
&lt;li>web-server (apache 2.2)&lt;/li>
&lt;li>database server (mySQL 5.6)&lt;/li>
&lt;li>php (php 5.4)&lt;/li>
&lt;li>RRDTool (1.4.8)&lt;/li>
&lt;li>net-snmp (5.7)&lt;/li>
&lt;/ol>
&lt;p>В скобках указаны версии, установленные мной на FreeBSD 10.0 (запущенной под Hyper-V в Windows 2012). Процесс установки подробно расписывать не буду. Я руководствовался этими ресурсами:&lt;/p>
&lt;ol>
&lt;li>&lt;a href="http://nix-sa.blogspot.ru/2011/08/cacti.html">Установка Cacti (краткая заметка)&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://habrahabr.ru/post/71087/">Кактус у монитора или ускоренная установка cacti&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://samag.ru/archive/article/1770">Cacti – простой и удобный инструмент для мониторинга и анализа сети&lt;/a> &lt;/li>
&lt;/ol>
&lt;p> Я давно не работал с UNIX-like системами, поэтому возникли некоторые проблемы (будьте осторожны выбирая пакеты, которые тянет php. Он может вытянуть иксы). Для тех, кто впервые ставит LAMP, советую почитать мануалы по установке и конфигурированию сервисов.&lt;/p>
&lt;p>Ставим &lt;a href="http://docs.cacti.net/plugin:mikrotik">плагин&lt;/a> для работы с Mikrotik (копируем папку в /usr/share/local/cacti/plugins и идем в веб-интерфейсе кактуса в Configuration - Plugin Management и нажимаем Install, Activate). При его установке выпадает ошибка. Лечится удалением строки &amp;lsquo;Invalid round robin archive&amp;rsquo; из /usr/local/share/cacti/plugins/mikrotik/templates/cacti_host_template_mikrotik_device.xml.&lt;/p>
&lt;p>Настраиваем SNMP на Mikrotik. IP -&amp;gt; SNMP -&amp;gt; Communities. Использовать стандартный public не рекомендую, т.к. он передаёт данные в открытом виде и без авторизации. Мы будем использовать SNMP v3, поддерживающий авторизацию и шифрование. Добавляем новую community:&lt;/p>
&lt;ul>
&lt;li>имя - любое (cacti)&lt;/li>
&lt;li>Addresses - адрес сервера SNMP (на котором стоит cacti)&lt;/li>
&lt;li>Security - authorized&lt;/li>
&lt;li>Read/write - выбираем по своему усмотрению, read нужен обязательно, а write только если планируем конфигурировать роутер по SNMP протоколу&lt;/li>
&lt;li>Протоколы авторизации и шифрования оставляем дефолтные&lt;/li>
&lt;li>Задаём пароль авторизации и парольную фразу для шифрования (могут быть разные значения)&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="http://3.bp.blogspot.com/-qeSZdaw9AGc/UxGx8cC4McI/AAAAAAAAAe0/Ck3khsntuKo/s1600/mt-snmp.png">&lt;img src="http://3.bp.blogspot.com/-qeSZdaw9AGc/UxGx8cC4McI/AAAAAAAAAe0/Ck3khsntuKo/s1600/mt-snmp.png" alt="">&lt;/a>&lt;/p>
&lt;p>В SNMP Settings пишем:&lt;/p>
&lt;ul>
&lt;li>Contact Info - почта админа&lt;/li>
&lt;li>Location - физическое расположение устройства&lt;/li>
&lt;li>Trap Target - адрес SNMP сервера&lt;/li>
&lt;li>Выбираем созданную нами Trap Community&lt;/li>
&lt;li>Trap Version - 3&lt;/li>
&lt;li>Trap Generation - кто будет генерировать сообщения для сервера - интерфейс или встроенный сервер&lt;/li>
&lt;li>Выбираем нужные интерфейсы&lt;/li>
&lt;/ul>
&lt;p>Добавляем в cacti наш микротик. Подробно распишу только про SNMP options:&lt;/p>
&lt;ul>
&lt;li>SNMP Version - 3&lt;/li>
&lt;li>SNMP Username (v3) -  имя нашего Community (cacti)&lt;/li>
&lt;li>SNMP Password (v3) - то, что ввели в Authentication Password в Mikrotik&lt;/li>
&lt;li>SNMP Privacy Passphrase (v3) - Encryption Password в Mikrotik&lt;/li>
&lt;/ul>
&lt;p>По дальнейшей работе с кактусом полно мануалов. Также есть отличная документация на оф. сайте, правда на английском. &lt;a href="http://mum.mikrotik.com/presentations/CZ09/schaub.pdf">Презентация&lt;/a> о настройке SNMP на Mikrotik.&lt;/p>
&lt;p>Первый час работы кактуса:&lt;/p>
&lt;p>&lt;a href="http://2.bp.blogspot.com/-Nmv5KEBWAUs/UxG0IYWDldI/AAAAAAAAAfA/rGKLw1ncLhA/s1600/Screenshot+from+2014-03-01+16:18:55.png">&lt;img src="http://2.bp.blogspot.com/-Nmv5KEBWAUs/UxG0IYWDldI/AAAAAAAAAfA/rGKLw1ncLhA/s1600/Screenshot+from+2014-03-01+16:18:55.png" alt="">&lt;/a>&lt;/p>
&lt;p>За сим откланяюсь. Постараюсь сочинить что-нибудь про The Dude. Да и про кактус, когда сам в нем разберусь.&lt;/p></content></item></channel></rss>