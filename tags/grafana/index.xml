<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>grafana on Bubnovd</title><link>https://bubnovd.github.io/tags/grafana/</link><description>Recent content in grafana on Bubnovd</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 27 May 2018 11:06:00 +0000</lastBuildDate><atom:link href="https://bubnovd.github.io/tags/grafana/index.xml" rel="self" type="application/rss+xml"/><item><title>[Мониторинг] Prometheus + Grafana. Часть 1. Общая информация</title><link>https://bubnovd.github.io/blogger/%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3-prometheus--grafana.-%D1%87%D0%B0%D1%81%D1%82%D1%8C-1.-%D0%BE%D0%B1%D1%89%D0%B0%D1%8F-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F/</link><pubDate>Sun, 27 May 2018 11:06:00 +0000</pubDate><guid>https://bubnovd.github.io/blogger/%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3-prometheus--grafana.-%D1%87%D0%B0%D1%81%D1%82%D1%8C-1.-%D0%BE%D0%B1%D1%89%D0%B0%D1%8F-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F/</guid><description>Система мониторинга - неотъемлемая часть ИТ инфраструктуры. Сеть не исключение. Для мониторинга сети уже написано много различных систем на разные вкусы:The Dude. Простая и быстрая в настройке и освоении система мониторинга от Mikrotik. Идеально подходит для небольших сетей или в случае, когда мониторинг нужен &amp;ldquo;вчера&amp;rdquo;Zabbix. Монструозный гигант. Долгое время стандарт де факто в мониторинге (да и сейчас, пожалуй). Умеет, не побоюсь этого слова, всё. Cacti. Легковесная мониторилка на основе RRDToolMRTG, PRTG и куча других системС распространением микросервисов функциональности и производительности существующих систем мониторинга стало не хватать и, что ожидаемо, начали разрабатываться и внедряться новые системы.</description><content>&lt;p>Система мониторинга - неотъемлемая часть ИТ инфраструктуры. Сеть не исключение. Для мониторинга сети уже написано много различных систем на разные вкусы:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->The Dude&lt;!-- raw HTML omitted -->. Простая и быстрая в настройке и освоении система мониторинга от Mikrotik. Идеально подходит для небольших сетей или в случае, когда мониторинг нужен &amp;ldquo;вчера&amp;rdquo;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Zabbix&lt;!-- raw HTML omitted -->. Монструозный гигант. Долгое время стандарт де факто в мониторинге (да и сейчас, пожалуй). Умеет, не побоюсь этого слова, всё. &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Cacti&lt;!-- raw HTML omitted -->. Легковесная мониторилка на основе RRDTool&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->MRTG&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->PRTG &lt;!-- raw HTML omitted -->и &lt;!-- raw HTML omitted -->куча &lt;!-- raw HTML omitted -->других &lt;!-- raw HTML omitted -->систем&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->С распространением микросервисов функциональности и производительности существующих систем мониторинга стало не хватать и, что ожидаемо, начали разрабатываться и внедряться новые системы. В очередном моём проекте как раз понадобилась система мониторинга. И чтобы не отставать от цивилизованного мира, я решил попробовать что-то новое. Выбор пал на стек Prometheus + Grafana. Чтобы как-то увлечь Вас, предлагаю посмотреть на демо интерфейс по &lt;!-- raw HTML omitted -->ссылке&lt;!-- raw HTML omitted -->.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Grafana&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Давайте рассмотрим что же из себя представляет этот стек.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->В современной разработке принято разделять продукт на несколько разных по назначению частей. Так система получается более масштабируемой и универсальной. Вот и здесь система мониторинга состоит из нескольких частей:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Prometheus&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Как написано по ссылке, это система мониторинга и time-series database. Prometheus принимает метрики из разных источников (exporters), записывает их в базу и предоставляет интерфейс для построения графиков и различных выборок.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Grafana&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Если предыдущая часть собирает и хранит данные, то эта - отображает их в удобной для пользователя форме. Посмотрите ещё раз &lt;!-- raw HTML omitted -->на интерфейс &lt;!-- raw HTML omitted -->- ну разве не волшебство?&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Prometheus получает данные от экспортеров в виде простого текста. Вроде этого:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --># HELP go_gc_duration_seconds A summary of the GC invocation durations.&lt;!-- raw HTML omitted --># TYPE go_gc_duration_seconds summary&lt;!-- raw HTML omitted -->go_gc_duration_seconds{quantile=&amp;ldquo;0&amp;rdquo;} 6.5914e-05&lt;!-- raw HTML omitted -->go_gc_duration_seconds{quantile=&amp;ldquo;0.25&amp;rdquo;} 0.000120385&lt;!-- raw HTML omitted -->go_gc_duration_seconds{quantile=&amp;ldquo;0.5&amp;rdquo;} 0.000150536&lt;!-- raw HTML omitted -->go_gc_duration_seconds{quantile=&amp;ldquo;0.75&amp;rdquo;} 0.000208313&lt;!-- raw HTML omitted -->go_gc_duration_seconds{quantile=&amp;ldquo;1&amp;rdquo;} 0.001072873&lt;!-- raw HTML omitted -->go_gc_duration_seconds_sum 0.333397658&lt;!-- raw HTML omitted -->go_gc_duration_seconds_count 1648&lt;!-- raw HTML omitted --># HELP go_goroutines Number of goroutines that currently exist.&lt;!-- raw HTML omitted --># TYPE go_goroutines gauge&lt;!-- raw HTML omitted -->go_goroutines 58&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Но эти данные ему ещё нужно доставить. Сами ведь они к нему не придут. Для этого существуют специальные модули, называемые exporters, которые позволяют отсылать данные Prometheus&amp;rsquo;у. Со списком можно ознакомиться &lt;!-- raw HTML omitted -->по ссылке&lt;!-- raw HTML omitted -->. Это что-то вроде Zabbix agent&amp;rsquo;ов. Есть экспортеры для Linux и Windows, MS SQL, MySQL, Nginx и других систем.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Так как нас в первую очередь интересует сеть, то и экспортировать нам надо SNMP. В этом нам поможет &lt;!-- raw HTML omitted -->SNMP_exporter&lt;!-- raw HTML omitted -->.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Таким образом, мы определились, что наш стек мониторинга будет работать на Prometheus, Grafana и snmp_exporter для Prometheus. Все эти модули можно менять на любые другие такого же назначения. Интерфейс Grafana можно заменить на Kibana (но не стоит этого делать - kibana совсем для других целей), а БД в виде Prometheus можно заменить на InfluxDB, Graphite или что-то ещё. Я выбрал именно Grafana + Prometheus + snmp_exporter за гибкий язык запросов prometheus  и гибкость и красоту grafana.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Чтобы ещё больше погрузиться в модные технологии, весь стек было решено поднимать в docker контейнерах. Вам совсем необязательно повторять этот трюк, но познакомиться с контейнерезацией в XXI веке тоже было бы неплохо.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->На этом пока всё. В следующей части установим и настроим сборку метрик с помощью prometheus и snmp_exporter.&lt;!-- raw HTML omitted -->&lt;/p></content></item></channel></rss>