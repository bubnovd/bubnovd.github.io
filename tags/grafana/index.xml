<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>grafana on Админская фамилия</title><link>https://bubnovd.net/tags/grafana/</link><description>Recent content in grafana on Админская фамилия</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 27 May 2018 11:06:00 +0000</lastBuildDate><atom:link href="https://bubnovd.net/tags/grafana/index.xml" rel="self" type="application/rss+xml"/><item><title>[Мониторинг] Prometheus + Grafana. Часть 1. Общая информация</title><link>https://bubnovd.net/blogger/%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3-prometheus--grafana.-%D1%87%D0%B0%D1%81%D1%82%D1%8C-1.-%D0%BE%D0%B1%D1%89%D0%B0%D1%8F-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F/</link><pubDate>Sun, 27 May 2018 11:06:00 +0000</pubDate><guid>https://bubnovd.net/blogger/%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3-prometheus--grafana.-%D1%87%D0%B0%D1%81%D1%82%D1%8C-1.-%D0%BE%D0%B1%D1%89%D0%B0%D1%8F-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F/</guid><description>Система мониторинга - неотъемлемая часть ИТ инфраструктуры. Сеть не исключение. Для мониторинга сети уже написано много различных систем на разные вкусы:
The Dude. Простая и быстрая в настройке и освоении система мониторинга от Mikrotik. Идеально подходит для небольших сетей или в случае, когда мониторинг нужен &amp;ldquo;вчера&amp;rdquo;
Zabbix. Монструозный гигант. Долгое время стандарт де факто в мониторинге (да и сейчас, пожалуй). Умеет, не побоюсь этого слова, всё. Cacti. Легковесная мониторилка на основе RRDTool</description><content>&lt;p>Система мониторинга - неотъемлемая часть ИТ инфраструктуры. Сеть не исключение. Для мониторинга сети уже написано много различных систем на разные вкусы:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="http://www.bubnovd.net/2017/05/thedudenetwork-managementandmonitoring.html">The Dude&lt;/a>. Простая и быстрая в настройке и освоении система мониторинга от Mikrotik. Идеально подходит для небольших сетей или в случае, когда мониторинг нужен &amp;ldquo;вчера&amp;rdquo;&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://www.zabbix.com/ru/">Zabbix&lt;/a>. Монструозный гигант. Долгое время стандарт де факто в мониторинге (да и сейчас, пожалуй). Умеет, не побоюсь этого слова, всё. &lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="http://www.bubnovd.net/2014/03/cacti-mikrotik-full-monitoring.html">Cacti&lt;/a>. Легковесная мониторилка на основе RRDTool&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://oss.oetiker.ch/mrtg/">MRTG&lt;/a>, &lt;a href="https://www.ru.paessler.com/prtg">PRTG&lt;/a> и &lt;a href="https://www.nagios.org/">куча&lt;/a> других &lt;a href="https://www.icinga.com/">систем&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>С распространением микросервисов функциональности и производительности существующих систем мониторинга стало не хватать и, что ожидаемо, начали разрабатываться и внедряться новые системы. В очередном моём проекте как раз понадобилась система мониторинга. И чтобы не отставать от цивилизованного мира, я решил попробовать что-то новое. Выбор пал на стек Prometheus + Grafana. Чтобы как-то увлечь Вас, предлагаю посмотреть на демо интерфейс по &lt;a href="https://play.grafana.org/d/000000003/big-dashboard?orgId=1">ссылке&lt;/a>.&lt;/p>
&lt;p>&lt;a href="https://3.bp.blogspot.com/-LyDAjmqZx7g/Wwrve4VCaXI/AAAAAAAAFP0/eicg99-DMPs07f5vrO_BbVTVzWEFRp_ZwCLcBGAs/s1600/grafana.PNG">&lt;img src="https://3.bp.blogspot.com/-LyDAjmqZx7g/Wwrve4VCaXI/AAAAAAAAFP0/eicg99-DMPs07f5vrO_BbVTVzWEFRp_ZwCLcBGAs/s640/grafana.PNG" alt="">&lt;/a>&lt;/p>
&lt;p>Grafana&lt;/p>
&lt;p>Давайте рассмотрим что же из себя представляет этот стек.&lt;/p>
&lt;p>В современной разработке принято разделять продукт на несколько разных по назначению частей. Так система получается более масштабируемой и универсальной. Вот и здесь система мониторинга состоит из нескольких частей:&lt;/p>
&lt;p>&lt;img src="https://avatars1.githubusercontent.com/u/3380462?s=200&amp;amp;v=4" alt="@prometheus">&lt;strong>&lt;a href="https://github.com/prometheus/prometheus">Prometheus&lt;/a>&lt;/strong>&lt;/p>
&lt;p>Как написано по ссылке, это система мониторинга и time-series database. Prometheus принимает метрики из разных источников (exporters), записывает их в базу и предоставляет интерфейс для построения графиков и различных выборок.&lt;/p>
&lt;p>&lt;img src="" alt="Grafana Icon"> &lt;strong>&lt;a href="https://grafana.com/">Grafana&lt;/a>&lt;/strong>&lt;/p>
&lt;p>Если предыдущая часть собирает и хранит данные, то эта - отображает их в удобной для пользователя форме. Посмотрите ещё раз &lt;a href="https://play.grafana.org/d/000000012/grafana-play-home?orgId=1">на интерфейс&lt;/a> - ну разве не волшебство?&lt;/p>
&lt;p>Prometheus получает данные от экспортеров в виде простого текста. Вроде этого:&lt;/p>
&lt;blockquote>
&lt;p># HELP go_gc_duration_seconds A summary of the GC invocation durations.&lt;br>
# TYPE go_gc_duration_seconds summary&lt;br>
go_gc_duration_seconds{quantile=&amp;ldquo;0&amp;rdquo;} 6.5914e-05&lt;br>
go_gc_duration_seconds{quantile=&amp;ldquo;0.25&amp;rdquo;} 0.000120385&lt;br>
go_gc_duration_seconds{quantile=&amp;ldquo;0.5&amp;rdquo;} 0.000150536&lt;br>
go_gc_duration_seconds{quantile=&amp;ldquo;0.75&amp;rdquo;} 0.000208313&lt;br>
go_gc_duration_seconds{quantile=&amp;ldquo;1&amp;rdquo;} 0.001072873&lt;br>
go_gc_duration_seconds_sum 0.333397658&lt;br>
go_gc_duration_seconds_count 1648&lt;br>
# HELP go_goroutines Number of goroutines that currently exist.&lt;br>
# TYPE go_goroutines gauge&lt;br>
go_goroutines 58&lt;/p>
&lt;/blockquote>
&lt;p>Но эти данные ему ещё нужно доставить. Сами ведь они к нему не придут. Для этого существуют специальные модули, называемые exporters, которые позволяют отсылать данные Prometheus&amp;rsquo;у. Со списком можно ознакомиться &lt;a href="https://prometheus.io/docs/instrumenting/exporters/">по ссылке&lt;/a>. Это что-то вроде Zabbix agent&amp;rsquo;ов. Есть экспортеры для Linux и Windows, MS SQL, MySQL, Nginx и других систем.&lt;/p>
&lt;p>Так как нас в первую очередь интересует сеть, то и экспортировать нам надо SNMP. В этом нам поможет &lt;a href="https://github.com/prometheus/snmp_exporter">SNMP_exporter&lt;/a>.&lt;/p>
&lt;p>Таким образом, мы определились, что наш стек мониторинга будет работать на Prometheus, Grafana и snmp_exporter для Prometheus. Все эти модули можно менять на любые другие такого же назначения. Интерфейс Grafana можно заменить на Kibana (но не стоит этого делать - kibana совсем для других целей), а БД в виде Prometheus можно заменить на InfluxDB, Graphite или что-то ещё. Я выбрал именно Grafana + Prometheus + snmp_exporter за гибкий язык запросов prometheus  и гибкость и красоту grafana.&lt;/p>
&lt;p>Чтобы ещё больше погрузиться в модные технологии, весь стек было решено поднимать в docker контейнерах. Вам совсем необязательно повторять этот трюк, но познакомиться с контейнерезацией в XXI веке тоже было бы неплохо.&lt;/p>
&lt;p>На этом пока всё. В следующей части установим и настроим сборку метрик с помощью prometheus и snmp_exporter.&lt;/p></content></item></channel></rss>