<!doctype html><html lang=en><head><title>Автоматизация :: Bubnovd</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/><link rel=stylesheet href=https://bubnovd.github.io/assets/style.css><link rel=stylesheet href=https://bubnovd.github.io/assets/blue.css><link rel=apple-touch-icon href=https://bubnovd.github.io/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://bubnovd.github.io/img/favicon/blue.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Автоматизация"><meta property="og:description" content><meta property="og:url" content="https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/"><meta property="og:site_name" content="Bubnovd"><meta property="og:image" content="https://bubnovd.github.io/img/favicon/blue.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><link href=/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/index.xml rel=alternate type=application/rss+xml title=Bubnovd></head><body class=blue><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=https://bubnovd.github.io/><div class=logo>Terminal</div></a></div></div></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/php-ipam.-%D0%B8%D0%BC%D0%BF%D0%BE%D1%80%D1%82-%D0%B8%D0%B7-excel/>PHP IPAM. Импорт из Excel</a></h1><div class=post-meta><span class=post-date>2016-11-16</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/csv/>csv</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/routeros/>routeros</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-ip-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%D0%BC%D0%B8/>Управление IP адресами</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/mikrotik/>Mikrotik</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/excel/>Excel</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/phpipam/>PHPIPAM</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>Автоматизация</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/ipam/>IPAM</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/the-dude/>The Dude</a>&nbsp;</span><div class=post-content>IP Address Management (сокращенно IPAM) – средство планирования, отслеживания и управления IP адресами в сети (via). В больших сетях отследить все используемые адреса и приготовиться к их изменению или внедрению новых – большая, трудновыполнимая задача. База данных IP адресов у многих ведется в различных табличка (Google Docs, Excel), у остальных не ведется совсем.При изменениях в сети оперировать информацией из этих мест становится все сложнее и документы быстро теряют свою актуальность.Именно поэтому было решено развернуть сервер управления IP адресами в нашей сети.</div><div><a class="read-more button" href=/blogger/php-ipam.-%D0%B8%D0%BC%D0%BF%D0%BE%D1%80%D1%82-%D0%B8%D0%B7-excel/>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B8-%D0%BD%D0%B0%D0%BB%D0%B8%D1%87%D0%B8%D1%8F-usb-%D0%BC%D0%BE%D0%B4%D0%B5%D0%BC%D0%B0-%D0%BD%D0%B0-routeros/>Скрипт для проверки наличия USB-модема на RouterOS</a></h1><div class=post-meta><span class=post-date>2015-03-01</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/routeros/>routeros</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/mikrotik/>Mikrotik</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/script/>script</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>Автоматизация</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82/>скрипт</a>&nbsp;</span><div class=post-content>Понадобился скрипт, определяющий наличие USB-модема, подключенного к Mikrotik. Присылает на почту название модема и его серийник. Хорошо бы допилить скрипт до отправки уровня сигнала и количества денег на счете, но мои модемы не дают доступа к своему меню - надо шить.:log info “Starting Modem Info Script…”;:local sysname [/system identity get name];:local sysver [/system package get system version];:local mname [/system resource usb get 1 value-name=name];:local mnumber [/system resource usb get 1 value-name=serial-number];:local smtpserv [:resolve “smtp.</div><div><a class="read-more button" href=/blogger/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B8-%D0%BD%D0%B0%D0%BB%D0%B8%D1%87%D0%B8%D1%8F-usb-%D0%BC%D0%BE%D0%B4%D0%B5%D0%BC%D0%B0-%D0%BD%D0%B0-routeros/>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F-%D0%BF%D0%BE%D1%80%D1%82%D0%B0-%D1%81%D0%B2%D0%B8%D1%82%D1%87%D0%B0-%D0%BF%D0%BE-%D0%BC%D0%B0%D0%BA%D1%83.-%D0%BE%D0%BF%D1%80%D0%BE%D1%81-%D0%BF%D0%BE-snmp/>Скрипт для выявления порта свитча по маку. Опрос по SNMP</a></h1><div class=post-meta><span class=post-date>2015-02-27</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/snmp/>SNMP</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/powershell/>PowerShell</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%BA%D0%BE%D0%BC%D0%BC%D1%83%D1%82%D0%B0%D1%82%D0%BE%D1%80/>коммутатор</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/l2/>L2</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%BA%D0%BE%D0%BC%D0%BC%D1%83%D1%82%D0%B0%D1%86%D0%B8%D1%8F/>коммутация</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>Автоматизация</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82/>скрипт</a>&nbsp;</span><div class=post-content>Допилил предыдущий скрипт . Необходимо знать аплинки каждого из свитчей. В моем случае, все они подключены к одному корневому (RootSwitch). Скрипт вытягивает по SNMP FDB таблицу корневого свитча, ищет в ней заданный MAC, сверяет его по заранее заданной таблице аплинков до свитчей доступа, переходит на следующий свитч и с него так же забирает FDB таблицу, а в ней уже ищет необходимый MAC. Информация выводится следующим образом “MAC, vlan, port корневого свитча; MAC, vlan, port конечного свитча”.</div><div><a class="read-more button" href=/blogger/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F-%D0%BF%D0%BE%D1%80%D1%82%D0%B0-%D1%81%D0%B2%D0%B8%D1%82%D1%87%D0%B0-%D0%BF%D0%BE-%D0%BC%D0%B0%D0%BA%D1%83.-%D0%BE%D0%BF%D1%80%D0%BE%D1%81-%D0%BF%D0%BE-snmp/>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/powershell.-%D0%B7%D0%B0%D0%BC%D0%B5%D1%82%D0%BA%D0%B8./>PowerShell. Заметки.</a></h1><div class=post-meta><span class=post-date>2013-06-11</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/powershell/>PowerShell</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/ms/>MS</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>Автоматизация</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82/>скрипт</a>&nbsp;</span><div class=post-content>Начал использовать PowerShell. Инструмент очень мощный. По мощности сравним с шеллом никсов. Не буду утверждать что круче - не разбираюсь ни в том, ни в другом. Решил сделать в качестве памятки несколько заметок по использованию этого инструмента.1. Заметка номер раз. Простейшие регулярные выражения в PS.^ - начало строки$ - конец строки. - один любой символУдалить подстроку или заменить её - -replace . Простейший способ редактирования строк без вникания в код и написания “нормальных” регэкспов - тупо удалить нужное кол-во символов.</div><div><a class="read-more button" href=/blogger/powershell.-%D0%B7%D0%B0%D0%BC%D0%B5%D1%82%D0%BA%D0%B8./>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%BE%D1%81-%D1%83%D1%87%D0%B5%D1%82%D0%BD%D1%8B%D1%85-%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B5%D0%B9-%D0%B2-%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD/>Перенос учетных записей в домен</a></h1><div class=post-meta><span class=post-date>2012-07-02</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/active-directory/>Active Directory</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/ms/>MS</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%BE%D1%81-%D0%BF%D1%80%D0%BE%D1%84%D0%B8%D0%BB%D1%8F/>перенос профиля</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>Автоматизация</a>&nbsp;</span><div class=post-content>Надоело переносить учетки пользователей из локальных в доменные при внедрении Active Directory. Решил найти автоматизированное решение. Оказывается не я первый озадачился этой проблемой =) Есть как минимум 5 вариантов автоматизации. Рассмотрим их по порядку.User State Migration Tool. Бесплатная утилита от Microsoft. Поставляется в комплекте Windows Automated Installation Kit. Используется из консоли. Мануал. У меня не получилось выполнить сохранение профиля - scanstate встал на последнем этапе на 1% и никак не реагировал.</div><div><a class="read-more button" href=/blogger/%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%BE%D1%81-%D1%83%D1%87%D0%B5%D1%82%D0%BD%D1%8B%D1%85-%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B5%D0%B9-%D0%B2-%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD/>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82.-%D0%B7%D0%B0%D0%BB%D0%B8%D0%B2%D0%BA%D0%B0-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%BD%D0%B0-ftp/>Скрипт. Заливка файлов на FTP</a></h1><div class=post-meta><span class=post-date>2011-08-15</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/bat/>bat</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>Автоматизация</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/cmd/>cmd</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82/>скрипт</a>&nbsp;</span><div class=post-content>Этот скрипт был написан для предотвращения нежелательных последствий от BSOD. Скрипт просматривает папку с дампами BSOD. Если дампы есть (синий экран был), то создаёт на FTP-сервере папку с датой создания дампа в качестве имени, а внутри неё папку с именем сбойной машины. И уже в эту папку копирует дампы. Затем переименовывает дампы в *.dmp.old, чтобы на следующий день их не копировать. Если скрипт запущен впервые, он копирует дампы как положено (каждый на свою дату).</div><div><a class="read-more button" href=/blogger/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82.-%D0%B7%D0%B0%D0%BB%D0%B8%D0%B2%D0%BA%D0%B0-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D0%BD%D0%B0-ftp/>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%BE%D0%B4%D0%BD%D1%8F%D1%82%D0%B8%D1%8F-pptp-%D0%B2-ubuntu/>Скрипт для поднятия pptp в Ubuntu</a></h1><div class=post-meta><span class=post-date>2010-12-06</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B5%D1%82/>Интернет</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/ubuntu/>ubuntu</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/vpn/>VPN</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/linux/>linux</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/internet/>internet</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/pptp/>PPTP</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%BB%D0%B8%D0%BD%D1%83%D0%BA%D1%81/>Линукс</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>Автоматизация</a>&nbsp;</span><div class=post-content>Каждый раз при включении компа прописыать роутинг и поднимать впн неудобно. Проще написать скрипт, который сделает всё это сам и кинуть его в автозагрузку.Вот скрипт:#!/bin/bash #указываем кто будет выполнять скрипт (bash)route del default #убираем дефолтный маршрутLOG="/var/log/pptp-run.log" #логи будут писаться в /var/log/pptp-run.logwhile true;do echo -e “\n==============================================\n date” >> $LOG /usr/sbin/pptp vpn.server.ru >> $LOG #вывод сообщений из pptp в pptp-run.log sleep 10;doneСохраняем его в /usr/local/bin/pptp-run-sh. Не забываем сделать его исполняемым: chmod +x pptp-run.</div><div><a class="read-more button" href=/blogger/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%BE%D0%B4%D0%BD%D1%8F%D1%82%D0%B8%D1%8F-pptp-%D0%B2-ubuntu/>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>Автоматизация</a></h1><div class=post-meta><span class=post-date>2010-10-26</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/autoit/>AutoIt</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>Автоматизация</a>&nbsp;</span><div class=post-content>Недавно по работе понадобилась сделать так, чтобы при появлении окошка от программы, в нем автоматически нажимались определенные кнопки и окошко закрывалось(чтобы не грузить пользователей лишней работой). Первые мысли - батник или VBScript. VBScript я совсем не знаю, хотя ради такого можно было разобраться. А вот насчет батника гугл сказал, что не прокатит. В итоге остановился на прекрасной программке - AutoIT. Это программка со скриптовым языком, позволяющая автоматизировать работу.Всё предельно просто. Мой скрипт ждал появление окошка, затем жал на кнопочку, потом во втором окошке - ещё одну, снова ждём около минуты и нажимаем ОК.</div><div><a class="read-more button" href=/blogger/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>→</a></div></div><div class=pagination><div class=pagination__buttons></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://bubnovd.github.io/assets/main.js></script>
<script src=https://bubnovd.github.io/assets/prism.js></script></div></body></html>