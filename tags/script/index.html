<!doctype html><html lang=en><head><title>script :: Bubnovd</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://bubnovd.github.io/tags/script/><link rel=stylesheet href=https://bubnovd.github.io/assets/style.css><link rel=stylesheet href=https://bubnovd.github.io/assets/blue.css><link rel=apple-touch-icon href=https://bubnovd.github.io/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://bubnovd.github.io/img/favicon/blue.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="script"><meta property="og:description" content><meta property="og:url" content="https://bubnovd.github.io/tags/script/"><meta property="og:site_name" content="Bubnovd"><meta property="og:image" content="https://bubnovd.github.io/img/favicon/blue.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><link href=/tags/script/index.xml rel=alternate type=application/rss+xml title=Bubnovd></head><body class=blue><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=https://bubnovd.github.io/><div class=logo>Terminal</div></a></div></div></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BF%D1%80%D0%BE%D0%BF%D1%83%D1%81%D0%BA%D0%BD%D0%BE%D0%B9-%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1%D0%BD%D0%BE%D1%81%D1%82%D0%B8-%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0-%D0%BD%D0%B0-mikrotik/>Проверка пропускной способности канала на Mikrotik</a></h1><div class=post-meta><span class=post-date>2017-12-21</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/bandwidth/>bandwidth</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/routeros/>routeros</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/mikrotik/>Mikrotik</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/script/>script</a>&nbsp;</span><div class=post-content>Скрипт для Mikrotik RouterOS, тестирующий пропускную способность канала и записывающий результат в файл. Перед запуском создать файл isp-quality.txt и указать IP своего btest сервера в ipbandswtestserverhttps://github.com/devi1/RouterOS-scripts/tree/master/bandwidth%20test:local txAvg 0:local rxAvg 0:local ipbandswtestserver your.btest.server.ip:local btuser btest:local btpwd btest:local ts [/system clock get time]:local ContentsFile [/file get isp-quality.txt contents]:local ds [/system clock get date]:set ts ([:pick $ts 0 2].[:pick $ts 3 5].[:pick $ts 6 8]):set ds ([:pick $ds 7 11].[:pick $ds 0 3].[:pick $ds 4 6])tool bandwidth-test protocol=tcp direction=transmit address=$ipbandswtestserver duration=5s do={:set txAvg ($“tx-total-average” / 1048576 );}tool bandwidth-test protocol=tcp direction=receive address=$ipbandswtestserver duration=5s do={:set rxAvg ($“rx-total-average” / 1048576 );}/file set isp-quality.</div><div><a class="read-more button" href=/blogger/%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BF%D1%80%D0%BE%D0%BF%D1%83%D1%81%D0%BA%D0%BD%D0%BE%D0%B9-%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1%D0%BD%D0%BE%D1%81%D1%82%D0%B8-%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0-%D0%BD%D0%B0-mikrotik/>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/%D0%BCikrotik-routeros-configuration-management-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D0%B2-%D0%B8-%D0%BA%D0%B0%D0%BA%D0%BE%D0%B9-%D1%82%D0%BE-%D1%82%D0%B0%D0%BC-%D0%BC%D0%B0%D1%82%D0%B5%D1%80%D0%B8/>Мikrotik RouterOS Configuration Management с помощью скриптов и какой-то там матери</a></h1><div class=post-meta><span class=post-date>2017-11-20</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/configuration-management/>configuration management</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/routeros/>routeros</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/mikrotik/>Mikrotik</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/script/>script</a>&nbsp;</span><div class=post-content>Жизненный цикл сети часто переживает закономерный рост. В это время начинают появляться десятки и сотни устройств, конфигурация которых однотипна. Например, это могут быть маршрутизаторы в филиалах, которые имеют одинаковые настройки и отличаются только IP адресами, паролями на VPN и Wi-Fi. Внесение даже незначительных изменений на десяток устройств потребует значительного времени и концентрации.Для управления сотнями и тысячами устройств весь цивилизованный мир уже давно использует специальные системы менеджмента конфигураций: Ansible, Chef, Puppet. Каждая из них имеет свои плюсы и минусы.</div><div><a class="read-more button" href=/blogger/%D0%BCikrotik-routeros-configuration-management-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D0%B2-%D0%B8-%D0%BA%D0%B0%D0%BA%D0%BE%D0%B9-%D1%82%D0%BE-%D1%82%D0%B0%D0%BC-%D0%BC%D0%B0%D1%82%D0%B5%D1%80%D0%B8/>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/yet-another-routeros-script/>Yet another RouterOS script</a></h1><div class=post-meta><span class=post-date>2015-12-09</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/routeros/>routeros</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/mikrotik/>Mikrotik</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/python/>python</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/script/>script</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/rsc/>rsc</a>&nbsp;</span><div class=post-content>Скрипт ищет интерфейс sstp клиента, имя которого содержит в себе строку video, копирует имя интерфейса, имя пользователя и пароль для подключения, а так же адрес vpn сервера. Удаляет упоминание об этом интерфейсе в настройках OSPF (т.к. после удаления появится интерфейс unknown, а без удаления интерфейса новый не создастся - имена одинаковые), создает нешифрованное соединение pptp с аналогичными настройками и вписывает его в параметры OSPF.#!Ищет sstp-интерфейс с именем, содержащим video#! копирует его настройки, убирает номер порта и#!</div><div><a class="read-more button" href=/blogger/yet-another-routeros-script/>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/%D1%81%D0%B0%D0%BC%D1%8B%D0%B9-%D0%BF%D0%BE%D0%BB%D0%BD%D1%8B%D0%B9-%D0%BC%D0%B0%D0%BD%D1%83%D0%B0%D0%BB-%D0%BF%D0%BE-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8E-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B5%D1%82%D0%B0-%D0%BD%D0%B0-mikrotik-routeros/>Самый полный мануал по резервированию интернета на Mikrotik RouterOS</a></h1><div class=post-meta><span class=post-date>2015-03-05</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/routeros/>routeros</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/mikrotik/>Mikrotik</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/script/>script</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/failover/>failover</a>&nbsp;</span><div class=post-content>В сети много мануалов по фэйловеру на RouterOS и подобрать нужный под конкретные цели иногда проблематично. В ходе своих экспериментов я выяснил, что наиболее универсальным является этот способ. Но у меня возникло несколько вопросов, ответы на которые я пока не нашел./ip routeadd dst-address=Host1 gateway=GW1 scope=10add dst-address=Host2 gateway=GW2 scope=10/ip routeadd distance=1 gateway=Host1 routing-mark=ISP1 check-gateway=pingadd distance=2 gateway=Host2 routing-mark=ISP1 check-gateway=ping/ip routeadd distance=1 gateway=Host2 routing-mark=ISP2 check-gateway=pingadd distance=2 gateway=Host1 routing-mark=ISP2 check-gateway=pingЯ делаю немного по-другому: первые две строки точно такие же, а дальше:/ip routeadd distance=1 gateway=Host1 check-gateway=pingadd distance=2 gateway=Host2 check-gateway=ping/ip routeadd distance=1 gateway=GW1 routing-mark=ISP1add distance=1 gateway=GW2 routing-mark=ISP2В первом варианте мне непонятно зачем пускать трафик, маркированный ISP1 по второму каналу и аналогично с ISP2.</div><div><a class="read-more button" href=/blogger/%D1%81%D0%B0%D0%BC%D1%8B%D0%B9-%D0%BF%D0%BE%D0%BB%D0%BD%D1%8B%D0%B9-%D0%BC%D0%B0%D0%BD%D1%83%D0%B0%D0%BB-%D0%BF%D0%BE-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8E-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B5%D1%82%D0%B0-%D0%BD%D0%B0-mikrotik-routeros/>→</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://bubnovd.github.io/blogger/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B8-%D0%BD%D0%B0%D0%BB%D0%B8%D1%87%D0%B8%D1%8F-usb-%D0%BC%D0%BE%D0%B4%D0%B5%D0%BC%D0%B0-%D0%BD%D0%B0-routeros/>Скрипт для проверки наличия USB-модема на RouterOS</a></h1><div class=post-meta><span class=post-date>2015-03-01</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span></div><span class=post-tags>#<a href=https://bubnovd.github.io/tags/routeros/>routeros</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/mikrotik/>Mikrotik</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/script/>script</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/>Автоматизация</a>&nbsp;
#<a href=https://bubnovd.github.io/tags/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82/>скрипт</a>&nbsp;</span><div class=post-content>Понадобился скрипт, определяющий наличие USB-модема, подключенного к Mikrotik. Присылает на почту название модема и его серийник. Хорошо бы допилить скрипт до отправки уровня сигнала и количества денег на счете, но мои модемы не дают доступа к своему меню - надо шить.:log info “Starting Modem Info Script…”;:local sysname [/system identity get name];:local sysver [/system package get system version];:local mname [/system resource usb get 1 value-name=name];:local mnumber [/system resource usb get 1 value-name=serial-number];:local smtpserv [:resolve “smtp.</div><div><a class="read-more button" href=/blogger/%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B4%D0%BB%D1%8F-%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B8-%D0%BD%D0%B0%D0%BB%D0%B8%D1%87%D0%B8%D1%8F-usb-%D0%BC%D0%BE%D0%B4%D0%B5%D0%BC%D0%B0-%D0%BD%D0%B0-routeros/>→</a></div></div><div class=pagination><div class=pagination__buttons></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://bubnovd.github.io/assets/main.js></script>
<script src=https://bubnovd.github.io/assets/prism.js></script></div></body></html>