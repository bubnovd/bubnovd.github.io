<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>FS on Bubnovd</title><link>https://bubnovd.github.io/tags/fs/</link><description>Recent content in FS on Bubnovd</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 20 Feb 2013 06:41:00 +0000</lastBuildDate><atom:link href="https://bubnovd.github.io/tags/fs/index.xml" rel="self" type="application/rss+xml"/><item><title>Настройка LVM</title><link>https://bubnovd.github.io/blogger/%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-lvm/</link><pubDate>Wed, 20 Feb 2013 06:41:00 +0000</pubDate><guid>https://bubnovd.github.io/blogger/%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-lvm/</guid><description>Наконец-то я добрался до своего уютненького бложика. Позже напишу для истории причину столь долгого перерыва, а сейчас только Linux, только хардкор.Итак, сегодня я наконец-то исполнил свои давнишние планы и поднял LVM на любимом Debian&amp;rsquo;e, не включавшемся последние полгода. Здесь и опишу как это было.Поехали. Имеем пингвина (в моем случае Debian). У меня 4 жестких диска. fdisk -l и /etc/fstab говорят вот о чем:sda 320 GB - sda1 /boot - sda2 / - sda3 /home - sda4 /swap sdb 160 GB - sdb1 /home/virtual/virtual2 - sdb2 - ntfs раздел Windows sdc 160 GB - sdc1 /home/virtual/virtual3 - sdc2 - ntfs раздел Windows sdd 1000 GB - sdd1 /home/video - sdd2 - не используется - sdd3 - не используетсяНачал с простого знакомства с LVM.</description><content>&lt;p>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Наконец-то я добрался до своего уютненького бложика. Позже напишу для истории причину столь долгого перерыва, а сейчас только Linux, только хардкор.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Итак, сегодня я наконец-то исполнил свои давнишние планы и поднял LVM на любимом Debian&amp;rsquo;e, не включавшемся последние полгода. Здесь и опишу как это было.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Поехали. Имеем пингвина (в моем случае Debian). У меня 4 жестких диска. fdisk -l и /etc/fstab говорят вот о чем:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->sda 320 GB&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sda1 /boot&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sda2 /&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sda3 /home&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sda4 /swap&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> sdb 160 GB&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sdb1 /home/virtual/virtual2&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sdb2 - ntfs раздел Windows&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> sdc 160 GB&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sdc1 /home/virtual/virtual3&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sdc2 - ntfs раздел Windows&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> sdd 1000 GB&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sdd1 /home/video&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sdd2 - не используется&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> - sdd3 - не используется&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Начал с простого знакомства с LVM. Решил один диск на 160 GB оставить под винду, второй на 160 - в LVM и зашифровать (тоже интересно покопаться с этой штукой), а 1000 GB и 360 GB объединить и разбить на несколько разделов. С количеством разделов пока не определился.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Для настройки LVM необходимо установить пакет lvm2:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> sudo aptitude install lvm2&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Все дальнейшие операции проводятся из под рута (делаем su).&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Создаём физические разделы:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> pvcreate /dev/sdb&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Сразу оно не завелось. Поэтому готовим хард:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> dd if-/dev/zero of=/dev/sdb bs=1k count=1k&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> blockdev &amp;ndash;rereadpt /dev/sdb&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> fdisk /dev/sdb&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> -t 0x8e&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> -w&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> pvcreate /dev/sdb&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->То же самое со вторым диском.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Создаём группу томов:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> vgcreate vg00 /dev/sdb /dev/sdd&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->И, наконец, на созданной группе создаем логические тома (разделы):&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> lvcreate -L 1000G -n lv00data&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->lv00data - название логического тома. Может быть любым.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->На этом работа с LVM закончена и начинается работа с файловой системой. Форматируем в нужню ФС. Я решил отформатировать раздел /data в XFS (т.к. именно эта ФС хорошо работает с большими фалами. Да и поковыряться с новой для меня ФС интересно). Из коробки Debian не умеет работать с этой ФС. Поэтому пришлось установить пару пакетов:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> aptitude install xfsprogs xfsdump&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Форматируем&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> mkfs.xfs /dev/vg00/lv00data&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Те же самые операции с остальными разделами.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->После перезагрузки тома из LVM не захотели монтироваться по UUID, хотя в последнем релизе Debian монтирование дисков происходит именно по UUID. Когда поправил /etc/fstab по названию тома - всё пришло в норму.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Ничего нового или оригинального в этом посте нет - просто на память. Вся инфа отсюда:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->xgu&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->habr&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Если не уверены в своих силах - сделайте бэкап данных. Учтите, что диски, используемые в LVM форматируются и таблица разделов на них сносится. Для меня это было первым шагом в LVM, дальше хочу перенести всю систему туда и зашифровать один раздел. Работающую систему переносить страшно, поэтому нутром чую, что следующий пост будет про бэкапы =)&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->UPD 29-05-2013:&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->XFS делайте только если оно вам действительно надо&lt;!-- raw HTML omitted -->. Т.е. если на 3 ТБ винте храните фильмы BD качества или большие БД. В большинстве случаев на домашней машине эта ФС не нужна. Запомните, она очень капризна и рассыпется практически без возможности восстановления при любом удобном случае. Например, моя гостья не нашла в меню выключение компьютера и просто дернула его из розетки. Хорошо хоть ничего особо ценного на разделе с XFS не было. Восстанавливать даже не пытался - времени не было.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> &lt;!-- raw HTML omitted -->&lt;/p></content></item></channel></rss>