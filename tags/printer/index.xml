<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>printer on Админская фамилия</title><link>https://bubnovd.net/tags/printer/</link><description>Recent content in printer on Админская фамилия</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 31 May 2011 06:46:00 +0000</lastBuildDate><atom:link href="https://bubnovd.net/tags/printer/index.xml" rel="self" type="application/rss+xml"/><item><title>Небольшой FAQ по настройке печати в RDP</title><link>https://bubnovd.net/blogger/%D0%BD%D0%B5%D0%B1%D0%BE%D0%BB%D1%8C%D1%88%D0%BE%D0%B9-faq-%D0%BF%D0%BE-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B5-%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%B8-%D0%B2-rdp/</link><pubDate>Tue, 31 May 2011 06:46:00 +0000</pubDate><guid>https://bubnovd.net/blogger/%D0%BD%D0%B5%D0%B1%D0%BE%D0%BB%D1%8C%D1%88%D0%BE%D0%B9-faq-%D0%BF%D0%BE-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B5-%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%B8-%D0%B2-rdp/</guid><description>При работе в терминальной сессии принтеры, которые мапятся на серв очень часто капризничают. Очень долго ковырял с чем это может быть связано. В итоге к конкретному решению так и не пришел, но всё, что узнал решил описать здесь.
Вообще сам протокол RDP довольно глючный, поэтому если у кого-то работает принтер в рдп, это ещё не значит, что у Вас на том же железе, с той же конфигурацией всё будет работать без проблем.</description><content>&lt;p>При работе в терминальной сессии принтеры, которые мапятся на серв очень часто капризничают. Очень долго ковырял с чем это может быть связано. В итоге к конкретному решению так и не пришел, но всё, что узнал решил описать здесь.&lt;/p>
&lt;p>Вообще сам протокол RDP довольно глючный, поэтому если у кого-то работает принтер в рдп, это ещё не значит, что у Вас на том же железе, с той же конфигурацией всё будет работать без проблем. Да и у того, у кого работает может через час отвалиться, а замапить принтер получится только с помощью плясок.&lt;/p>
&lt;p>По RDP могут корректно работать только те принтеры, в названии которых присутствуют 3 заветные буковки: PCL. Соответственно драйвера на них нужны тоже PCL. Существует как минимум 2 разновидности этих драйверов: PCL5 и PCL6. Говорят, 6-я версия глючная, поэтому ставить нужно 5-ую. Также существует разница в версиях RDP. Маппинг принтеров поддерживается только в версиях RDP начиная с 5.2 (Windows Server 2003), в версию 6.1 (Windows Server 2008) входит Terminal Services Easy Print driver (позволяет не устанавливать драйвера клиентских принтеров на сервере).  Но это тоже глючная херня и полагаться на неё не стОит.&lt;/p>
&lt;p>Принтеры, подключенные локально к порту, имя которого начинается не с букв COM, LPT или USB печатать так просто не захотят (&lt;a href="http://support.microsoft.com/kb/302361">http://support.microsoft.com/kb/302361&lt;/a>). &lt;/p>
&lt;p>Ещё один костыль для исправления этой проблемы:&lt;br>
1. Устанавливаем локальный USB принтер у клиента стандартным образом;&lt;br>
2. Расшариваем его;&lt;br>
3. даём команду:&lt;br>
net use lpt1: \\имя_компа\имя_принтера /PERSISTENT:YES&lt;br>
4. Устанавливаем новый &amp;ldquo;виртуальный&amp;rdquo; принтер, якобы подключенный к lpt1 и назначаем его по-умолчанию;&lt;br>
5. Всё, после этой операции любой USB принтер, вне зависимости от заявленной производителем совместимости, замечательно видится при подключении к терминалу. (&lt;a href="http://forum.windowsfaq.ru/showthread.php?t=97478">http://forum.windowsfaq.ru/showthread.php?t=97478&lt;/a>)&lt;/p>
&lt;p>Естественно, должна стоять галочка &amp;ldquo;использовать локальные принтеры&amp;rdquo; на клиенте и снята галочка &amp;ldquo;запретить перенаправление принтеров&amp;rdquo; на сервере. Имя принтера должно в точности (вплоть до регистра) совпадать с именем его драйвера на сервере. &lt;/p>
&lt;p>Ещё можно попробовать установить следующие пакеты:&lt;/p>
&lt;p>1. MicrosoftFixit50180&lt;/p>
&lt;p>2. WindowsXP-KB972422-x86-RUS&lt;/p>
&lt;p>А ещё лучше использовать пакет ScrewDrivers и подобные, но это довольно дорого.&lt;br>
Насчет ScrewDrivers вот что мне ответили на одном известном форуме: &amp;ldquo;Дорого, потому что нет лучшего решения. Всё что ты выше написал - мура, проверенная многолетней еблей с печатью. &amp;quot; Так что решайтесь =)&lt;/p>
&lt;p>Информация отсюда:&lt;br>
1. &lt;a href="http://ru.wikipedia.org/wiki/Remote_Desktop_Protocol">http://ru.wikipedia.org/wiki/Remote_Desktop_Protocol&lt;/a>&lt;br>
2. &lt;a href="http://www.gotdotnet.ru/blogs/blackhawk/1243/">http://www.gotdotnet.ru/blogs/blackhawk/1243/&lt;/a>&lt;br>
3. &lt;a href="http://www.tonk.ru/support/faq/printers02/">http://www.tonk.ru/support/faq/printers02/&lt;/a>&lt;br>
4. &lt;a href="http://www.tonk.ru/support/faq/printers01/">http://www.tonk.ru/support/faq/printers01/&lt;/a> &lt;/p>
&lt;p>    &lt;a href="http://www.osp.ru/win2000/2001/02/174688/">http://www.osp.ru/win2000/2001/02/174688/&lt;/a>&lt;/p>
&lt;p>UPD:&lt;br>
Большинство принтеров будут корректно работать в терминальной сессии, если разрядность операционных систем сервера и клиента совпадает. То есть если на серве Windows 2008R2 (а она выпускается только в 64-разрядной редакции), а на клиенте - Win XP 32, то 90%, что принтер в терминале печатать не будет. А если на клиенте Windows 7 x64 - 90%, что проблем не будет.&lt;br>
 Возможно, ещё играет роль семейство ОС (т.е. Win7 не будет печатать на WinServ2003 и наоборот). Хотя это лишь догадки - не проверял. Если кто знает - добро пожаловать в комменты!&lt;br>
Если клиент не в локальной сети, а в интернете - поднимайте VPN.&lt;br>
Ещё можно почитать &lt;a href="http://sysadmins.ru/post8112079.html">здесь&lt;/a>.&lt;/p></content></item></channel></rss>