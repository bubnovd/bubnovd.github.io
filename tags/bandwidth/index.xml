<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>bandwidth on Bubnovd</title><link>https://bubnovd.github.io/tags/bandwidth/</link><description>Recent content in bandwidth on Bubnovd</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 21 Dec 2017 08:52:00 +0000</lastBuildDate><atom:link href="https://bubnovd.github.io/tags/bandwidth/index.xml" rel="self" type="application/rss+xml"/><item><title>Проверка пропускной способности канала на Mikrotik</title><link>https://bubnovd.github.io/blogger/%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BF%D1%80%D0%BE%D0%BF%D1%83%D1%81%D0%BA%D0%BD%D0%BE%D0%B9-%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1%D0%BD%D0%BE%D1%81%D1%82%D0%B8-%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0-%D0%BD%D0%B0-mikrotik/</link><pubDate>Thu, 21 Dec 2017 08:52:00 +0000</pubDate><guid>https://bubnovd.github.io/blogger/%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BF%D1%80%D0%BE%D0%BF%D1%83%D1%81%D0%BA%D0%BD%D0%BE%D0%B9-%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1%D0%BD%D0%BE%D1%81%D1%82%D0%B8-%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0-%D0%BD%D0%B0-mikrotik/</guid><description>Скрипт для Mikrotik RouterOS, тестирующий пропускную способность канала и записывающий результат в файл. Перед запуском создать файл isp-quality.txt и указать IP своего btest сервера в ipbandswtestserverhttps://github.com/devi1/RouterOS-scripts/tree/master/bandwidth%20test:local txAvg 0:local rxAvg 0:local ipbandswtestserver your.btest.server.ip:local btuser btest:local btpwd btest:local ts [/system clock get time]:local ContentsFile [/file get isp-quality.txt contents]:local ds [/system clock get date]:set ts ([:pick $ts 0 2].[:pick $ts 3 5].[:pick $ts 6 8]):set ds ([:pick $ds 7 11].[:pick $ds 0 3].[:pick $ds 4 6])tool bandwidth-test protocol=tcp direction=transmit address=$ipbandswtestserver duration=5s do={:set txAvg ($&amp;ldquo;tx-total-average&amp;rdquo; / 1048576 );}tool bandwidth-test protocol=tcp direction=receive address=$ipbandswtestserver duration=5s do={:set rxAvg ($&amp;ldquo;rx-total-average&amp;rdquo; / 1048576 );}/file set isp-quality.</description><content>&lt;p>Скрипт для Mikrotik RouterOS, тестирующий пропускную способность канала и записывающий результат в файл. Перед запуском создать файл isp-quality.txt и указать IP своего btest сервера в ipbandswtestserver&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;a href="https://github.com/devi1/RouterOS-scripts/tree/master/bandwidth%20test">https://github.com/devi1/RouterOS-scripts/tree/master/bandwidth%20test&lt;/a>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->:local txAvg 0&lt;!-- raw HTML omitted -->:local rxAvg 0&lt;!-- raw HTML omitted -->:local ipbandswtestserver your.btest.server.ip&lt;!-- raw HTML omitted -->:local btuser btest&lt;!-- raw HTML omitted -->:local btpwd btest&lt;!-- raw HTML omitted -->:local ts [/system clock get time]&lt;!-- raw HTML omitted -->:local ContentsFile [/file get isp-quality.txt contents]&lt;!-- raw HTML omitted -->:local ds [/system clock get date]&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->:set ts ([:pick $ts 0 2].[:pick $ts 3 5].[:pick $ts 6 8])&lt;!-- raw HTML omitted -->:set ds ([:pick $ds 7 11].[:pick $ds 0 3].[:pick $ds 4 6])&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->tool bandwidth-test protocol=tcp direction=transmit address=$ipbandswtestserver duration=5s do={&lt;!-- raw HTML omitted -->:set txAvg ($&amp;ldquo;tx-total-average&amp;rdquo; / 1048576 );&lt;!-- raw HTML omitted -->}&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->tool bandwidth-test protocol=tcp direction=receive address=$ipbandswtestserver duration=5s do={&lt;!-- raw HTML omitted -->:set rxAvg ($&amp;ldquo;rx-total-average&amp;rdquo; / 1048576 );&lt;!-- raw HTML omitted -->}&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->/file set isp-quality.txt contents=&amp;quot;$ContentsFile\n$ds-$ts tx: $txAvg Mbps - rx: $rxAvg Mbps&amp;quot;&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;/p></content></item><item><title>Dude и SNMP</title><link>https://bubnovd.github.io/blogger/dude-%D0%B8-snmp/</link><pubDate>Tue, 03 Mar 2015 01:19:00 +0000</pubDate><guid>https://bubnovd.github.io/blogger/dude-%D0%B8-snmp/</guid><description>Про The Dude я уже писал. Отличная система мониторинга для сетей, построенных на базе оборудования Mikrotik. Столкнулся со следующей проблемой: хочу получить графики пропускной способности интерфейсов коммутаторов не строя при этом связи между портом коммутатора и конечным устройством на схеме (ну не надо мне перегружать карту клиентскими компами/телефонами). Что-то подобное Dude организовать может, но в ходе чтения различных материалов и обсуждений конкретного решения я не нашел и пришлось копать дальше в тему.</description><content>&lt;p>Про The Dude я уже писал. Отличная система мониторинга для сетей, построенных на базе оборудования Mikrotik. Столкнулся со следующей проблемой: хочу получить графики пропускной способности интерфейсов коммутаторов не строя при этом связи между портом коммутатора и конечным устройством на схеме (ну не надо мне перегружать карту клиентскими компами/телефонами). Что-то подобное Dude организовать может, но в ходе чтения различных материалов и обсуждений конкретного решения я не нашел и пришлось копать дальше в тему. Для нетерпеливых: ответа я пока не нашел.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Итак, мы можем опросить устройство по SNMP и произвести какие-либо манипуляции с полученными данными средствами самой дудки. Стандартный SNMP позволяет нам увидеть следующие параметры:&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->ifSpeed&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->1.3.6.1.2.1.2.2.1.5&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Текущая скорость интерфейса в битах за секунду.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->ifInOctets&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->1.3.6.1.2.1.2.2.1.10&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Полное число полученных байтов, включая символы заголовков&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->ifOutOctets&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->1.3.6.1.2.1.2.2.1.16&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Полное количество отправленных октетов с интерфейса, включая символы заголовков.&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Сначала я думал, что первая строчка этой таблицы спасет меня. Но нет - она показывает скорость, в которую установлен интерфейс (10/100/1000 Мб/с). Соответственно, ковырять придется второй и третий параметры. Вычислить скорость, исходя из полученных данных можно так: &lt;!-- raw HTML omitted -->(ifInOctets(time1) - ifInOctets(time2)) / (time2 - time1)&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->Но вот проблема: куда записать текущее значение полученных байтов, чтобы потом вычесть одно из другого. Тут должны помочь функции, встроенные в Dude. Но использование переменных я в них не нашел. Поэтому откладываю эту задачку на неопределенное время. &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->На форуме предлагают решение для The Dude 3.6, но в 4 версии оно не работает. Ссылки, которые дали информацию для размышлений: &lt;!-- raw HTML omitted -->1&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->2&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->3&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->4&lt;!-- raw HTML omitted -->, &lt;!-- raw HTML omitted -->5&lt;!-- raw HTML omitted -->. &lt;!-- raw HTML omitted -->&lt;/p></content></item></channel></rss>