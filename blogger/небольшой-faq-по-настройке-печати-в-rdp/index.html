<!doctype html><html lang=en><head><title>Небольшой FAQ по настройке печати в RDP :: Админская фамилия</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="При работе в терминальной сессии принтеры, которые мапятся на серв очень часто капризничают. Очень долго ковырял с чем это может быть связано. В итоге к конкретному решению так и не пришел, но всё, что узнал решил описать здесь.
Вообще сам протокол RDP довольно глючный, поэтому если у кого-то работает принтер в рдп, это ещё не значит, что у Вас на том же железе, с той же конфигурацией всё будет работать без проблем."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://bubnovd.net/blogger/%D0%BD%D0%B5%D0%B1%D0%BE%D0%BB%D1%8C%D1%88%D0%BE%D0%B9-faq-%D0%BF%D0%BE-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B5-%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%B8-%D0%B2-rdp/><link rel=stylesheet href=https://bubnovd.net/assets/style.css><link rel=stylesheet href=https://bubnovd.net/assets/blue.css><link rel=apple-touch-icon href=https://bubnovd.net/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://bubnovd.net/img/favicon/blue.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Небольшой FAQ по настройке печати в RDP"><meta property="og:description" content="При работе в терминальной сессии принтеры, которые мапятся на серв очень часто капризничают. Очень долго ковырял с чем это может быть связано. В итоге к конкретному решению так и не пришел, но всё, что узнал решил описать здесь.
Вообще сам протокол RDP довольно глючный, поэтому если у кого-то работает принтер в рдп, это ещё не значит, что у Вас на том же железе, с той же конфигурацией всё будет работать без проблем."><meta property="og:url" content="https://bubnovd.net/blogger/%D0%BD%D0%B5%D0%B1%D0%BE%D0%BB%D1%8C%D1%88%D0%BE%D0%B9-faq-%D0%BF%D0%BE-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B5-%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%B8-%D0%B2-rdp/"><meta property="og:site_name" content="Админская фамилия"><meta property="og:image" content="https://bubnovd.net/img/favicon/blue.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2011-05-31 06:46:00 +0000 UTC"></head><body class=blue><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=https://bubnovd.net/><div class=logo>Terminal</div></a></div></div></header><div class=content><div class=post><h1 class=post-title><a href=https://bubnovd.net/blogger/%D0%BD%D0%B5%D0%B1%D0%BE%D0%BB%D1%8C%D1%88%D0%BE%D0%B9-faq-%D0%BF%D0%BE-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B5-%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%B8-%D0%B2-rdp/>Небольшой FAQ по настройке печати в RDP</a></h1><div class=post-meta><span class=post-date>2011-05-31</span>
<span class=post-author>:: map[name:devi1 uri:https://www.blogger.com/profile/05777499482649623616]</span>
<span class=post-reading-time>:: 3 min read (468 words)</span></div><span class=post-tags>#<a href=https://bubnovd.net/tags/%D1%82%D0%B5%D1%80%D0%BC%D0%B8%D0%BD%D0%B0%D0%BB/>терминал</a>&nbsp;
#<a href=https://bubnovd.net/tags/microsoft/>Microsoft</a>&nbsp;
#<a href=https://bubnovd.net/tags/rdp/>RDP</a>&nbsp;
#<a href=https://bubnovd.net/tags/terminal/>terminal</a>&nbsp;
#<a href=https://bubnovd.net/tags/windows/>windows</a>&nbsp;
#<a href=https://bubnovd.net/tags/printer/>printer</a>&nbsp;
#<a href=https://bubnovd.net/tags/%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D1%8C/>печать</a>&nbsp;</span><div class=post-content><div><p>При работе в терминальной сессии принтеры, которые мапятся на серв очень часто капризничают. Очень долго ковырял с чем это может быть связано. В итоге к конкретному решению так и не пришел, но всё, что узнал решил описать здесь.</p><p>Вообще сам протокол RDP довольно глючный, поэтому если у кого-то работает принтер в рдп, это ещё не значит, что у Вас на том же железе, с той же конфигурацией всё будет работать без проблем. Да и у того, у кого работает может через час отвалиться, а замапить принтер получится только с помощью плясок.</p><p>По RDP могут корректно работать только те принтеры, в названии которых присутствуют 3 заветные буковки: PCL. Соответственно драйвера на них нужны тоже PCL. Существует как минимум 2 разновидности этих драйверов: PCL5 и PCL6. Говорят, 6-я версия глючная, поэтому ставить нужно 5-ую. Также существует разница в версиях RDP. Маппинг принтеров поддерживается только в версиях RDP начиная с 5.2 (Windows Server 2003), в версию 6.1 (Windows Server 2008) входит Terminal Services Easy Print driver (позволяет не устанавливать драйвера клиентских принтеров на сервере).  Но это тоже глючная херня и полагаться на неё не стОит.</p><p>Принтеры, подключенные локально к порту, имя которого начинается не с букв COM, LPT или USB печатать так просто не захотят (<a href=http://support.microsoft.com/kb/302361>http://support.microsoft.com/kb/302361</a>). </p><p>Ещё один костыль для исправления этой проблемы:<br>1. Устанавливаем локальный USB принтер у клиента стандартным образом;<br>2. Расшариваем его;<br>3. даём команду:<br>net use lpt1: \\имя_компа\имя_принтера /PERSISTENT:YES<br>4. Устанавливаем новый &ldquo;виртуальный&rdquo; принтер, якобы подключенный к lpt1 и назначаем его по-умолчанию;<br>5. Всё, после этой операции любой USB принтер, вне зависимости от заявленной производителем совместимости, замечательно видится при подключении к терминалу. (<a href="http://forum.windowsfaq.ru/showthread.php?t=97478">http://forum.windowsfaq.ru/showthread.php?t=97478</a>)</p><p>Естественно, должна стоять галочка &ldquo;использовать локальные принтеры&rdquo; на клиенте и снята галочка &ldquo;запретить перенаправление принтеров&rdquo; на сервере. Имя принтера должно в точности (вплоть до регистра) совпадать с именем его драйвера на сервере. </p><p>Ещё можно попробовать установить следующие пакеты:</p><p>1. MicrosoftFixit50180</p><p>2. WindowsXP-KB972422-x86-RUS</p><p>А ещё лучше использовать пакет ScrewDrivers и подобные, но это довольно дорого.<br>Насчет ScrewDrivers вот что мне ответили на одном известном форуме: &ldquo;Дорого, потому что нет лучшего решения. Всё что ты выше написал - мура, проверенная многолетней еблей с печатью. " Так что решайтесь =)</p><p>Информация отсюда:<br>1. <a href=http://ru.wikipedia.org/wiki/Remote_Desktop_Protocol>http://ru.wikipedia.org/wiki/Remote_Desktop_Protocol</a><br>2. <a href=http://www.gotdotnet.ru/blogs/blackhawk/1243/>http://www.gotdotnet.ru/blogs/blackhawk/1243/</a><br>3. <a href=http://www.tonk.ru/support/faq/printers02/>http://www.tonk.ru/support/faq/printers02/</a><br>4. <a href=http://www.tonk.ru/support/faq/printers01/>http://www.tonk.ru/support/faq/printers01/</a> </p><p>    <a href=http://www.osp.ru/win2000/2001/02/174688/>http://www.osp.ru/win2000/2001/02/174688/</a></p><p>UPD:<br>Большинство принтеров будут корректно работать в терминальной сессии, если разрядность операционных систем сервера и клиента совпадает. То есть если на серве Windows 2008R2 (а она выпускается только в 64-разрядной редакции), а на клиенте - Win XP 32, то 90%, что принтер в терминале печатать не будет. А если на клиенте Windows 7 x64 - 90%, что проблем не будет.<br> Возможно, ещё играет роль семейство ОС (т.е. Win7 не будет печатать на WinServ2003 и наоборот). Хотя это лишь догадки - не проверял. Если кто знает - добро пожаловать в комменты!<br>Если клиент не в локальной сети, а в интернете - поднимайте VPN.<br>Ещё можно почитать <a href=http://sysadmins.ru/post8112079.html>здесь</a>.</p></div></div><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//bubnovd-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://bubnovd.net/assets/main.js></script>
<script src=https://bubnovd.net/assets/prism.js></script></div></body></html>