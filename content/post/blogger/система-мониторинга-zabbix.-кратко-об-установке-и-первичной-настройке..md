+++
title = "Система мониторинга Zabbix. Кратко об установке и первичной настройке."
date = 2011-04-15T01:50:00Z
updated = 2013-05-29T11:49:06Z
tags = ["ubuntu", "linux", "monitoring", "zabbix"]
blogimport = true 
[author]
	name = "devi1"
	uri = "https://www.blogger.com/profile/05777499482649623616"
+++

<span class="Apple-style-span" style="font-family: sans-serif; font-size: 13px; line-height: 19px;"></span><br /><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Zabbix - система для мониторинга состояния сетей, включая рабочие станции, сервера, маршрутизаторы, коммутаторы и т.д. Серверная часть работает на UNIX-подобных ОС. Данные о работе устройств собираются посредством протокола SNMP, системы IPMI и Zabbix-агента. Клинтская часть работает на всех распространенных ОС.</div><h3 style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; border-bottom-color: initial; border-bottom-style: none; border-bottom-width: initial; font-size: 17px; font-weight: bold; margin-bottom: 0.3em; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0.17em; padding-top: 0.5em; width: auto;"><span class="mw-headline" id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80.D0.BD.D0.BE.D0.B9_.D1.87.D0.B0.D1.81.D1.82.D0.B8"><a name='more'></a><br /><span class="Apple-style-span" style="color: white;"> Установка серверной части</span></span></h3><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Часть взята отсюда:&nbsp;<a href="http://wiki.enchtex.info/howto/zabbix/zabbix-ubuntu-8.04">http://wiki.enchtex.info/howto/zabbix/zabbix-ubuntu-8.04</a></div><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">sudo apt-get install zabbix-server-mysql zabbix-agent zabbix-frontend-php</div><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Если MySQL уже установлена, то необходимо ввести пароль администратора БД. Иначе - задать новый пароль для администратора БД. Все настройки хранятся в /etc/zabbix.</div><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">После установки открываем в браузере&nbsp;http://serverIP/zabbix. По умолчанию логин Admin, без пароля. Для Ubuntu 10.xx и выше логин/пароль admin/zabbix. Если веб-интерфейс выдает предупреждение: "Timezone for PHP is not set. Please set "date.timezone" option in php.ini.", то в /etc/php5/apache2/php.ini следует указать часовой пояс "date.timezone = Asia/Yekaterinburg" (nano /etc/php5/apache/php.ini) и перезапустить apache: /etc/init.d/apache2 restart. Если всплывает ещё одно предупреждение "PHP max execution time: 30 sec Fail", то в том же файле указываем время выполнения скриптов 300 сек. "max_execution_time = 300" и снова перезапускаем веб-сервер. Далее заходим в меню - Administration -&gt; Installation жмем Next, соглашаемся с условиями лицензии и проверяем рекомендуемые настройки. Если строчка выделена красным, значит следует изменить соответствующее значение в указанном выше php.ini на рекомендуемое (указано в столбце Recommended). Дальше проверяем соединение с БД (необходимо ввести пароль администратора БД, который вводили при установке).</div><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Если что-то не получается необходимо выполнить следующие действия:</div><ul style="line-height: 1.5em; list-style-image: url(http://wiki.mag-soft.ru/skins/vector/images/bullet-icon.png); list-style-type: square; margin-bottom: 0px; margin-left: 1.5em; margin-right: 0px; margin-top: 0.3em; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><li style="margin-bottom: 0.1em;">Проверить файл /etc/zabbix/dbconfig.php. В нем должны быть указаны правильные учетные данные и IP сервера (локальный 192.168.0.1).</li><li style="margin-bottom: 0.1em;">В файле /etc/zabbix/zabbix-server.conf все настройки оставляем по умолчанию, за исключением адреса сервера. Его ставим таким же как и dbconfig.php. Строка FpingLocation по умолчанию указывает в неверную для Ubuntu директорию. Указываем /usr/bin/fping.</li><li style="margin-bottom: 0.1em;">В файле zabbix_agent.conf указываем IP нашего сервера (server = 192.168.0.1) и отображаемое в Zabbix имя хоста (Hostname = zabbix_client1). Остальные параметры не меняем.</li></ul><h3 style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; border-bottom-color: initial; border-bottom-style: none; border-bottom-width: initial; font-size: 17px; font-weight: bold; margin-bottom: 0.3em; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0.17em; padding-top: 0.5em; width: auto;"><span class="mw-headline" id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BA.D0.BB.D0.B8.D0.B5.D0.BD.D1.82.D1.81.D0.BA.D0.BE.D0.B9_.D1.87.D0.B0.D1.81.D1.82.D0.B8_.D0.BD.D0.B0_Windows"><br /><span class="Apple-style-span" style="color: white;"> Установка клиентской части на Windows</span></span></h3><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Отсюда&nbsp;<a href="http://www.zabbix.com/ru/download.php">http://www.zabbix.com/ru/download.php</a>&nbsp;скачиваем zabbix-агент для нашей ОС.</div><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Копируем /etc/zabbix/zabbix_agentd.conf с сервера на клиент (в C:\program files\zabbix). Меняем в нем имя хоста. Можно также поменять уровень логирования (DebugLevel = 4), на случай если агент не сможет подключиться к серверу в C:\program files\zabbix\zabbix_agentd.log можно будет увидеть подробный отчет о работе агента.</div><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Агент устанавливается в качестве службы. Для установки следует запустить командную строку с правами администратора, перейти в папку с zabbix-агентом и выполнить zabbix_agentd.exe -i -c "C:\program files\zabbix\zabbix_agentd.conf". Служба автоматически не запускается, поэтому следует запустить её из оснастки "Управление компьютером".</div><div style="margin: 0.4em 0px 0.5em;"><span style="line-height: 1.5em;">Фаервол должен пропускать трафик на порту 10050.</span><br /><br /><br /><br /><b> Добавление хостов</b><br />В веб-интерфейсе Zabbix открываем в меню Configuration -&gt; Hosts. Жмём Create Host. Вводим имя хоста, его группу, IP-адрес и устанавливаем статус monitored. В правой части в панели Linked Templates жмём Add и выбираем тип хоста (в нашем случае Template Windows, вверху в группах необходимо выбрать Templates)<br /><br /><br /><br /> <br /><br /><br />Для проверки корректности подключения клиентов можно в консоли сервера выполнить команду zabbix_get -s %client-IP% -k system.uname В ответ должны получить название ОС.<br /><br /><br /> <br /><br />UPD 02.08.11<br /><br />Новый пост на хабре про Zabbix: <a href="http://habrahabr.ru/blogs/sysadm/125340/">http://habrahabr.ru/blogs/sysadm/125340/</a></div>
