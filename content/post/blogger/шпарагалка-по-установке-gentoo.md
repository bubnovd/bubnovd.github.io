+++
title = "Шпарагалка по установке gentoo"
date = 2011-05-26T21:51:00Z
updated = 2013-05-29T11:48:28Z
tags = ["inux", "установка", "install", "gentoo"]
blogimport = true 
[author]
	name = "devi1"
	uri = "https://www.blogger.com/profile/05777499482649623616"
+++

<br /><br />Шпарагалка по установке gentoo. Скопипизжено отсюда: <a href="http://freehabr.ru/blog/17.html">http://freehabr.ru/blog/17.html</a><br /><br /><br /><br /><br /><br /><br /><br /><br /> <br /><br />1. Разметка<br /> # fdisk /dev/sda<br /> <br /> 2. Форматирование разделов<br /> # mkfs -t &lt;тип_ФС&gt; /dev/sda&lt;номер_раздела&gt;<br /> и т.д.<br /> <br /> Установка базовой системы<br /> <br /> 3. Монтирование разделов<br /> # mount /dev/sda&lt;номер_раздела&gt; /mnt/gentoo/&lt;путь&gt;<br /> и т.д.<br /> <br /> 4. Переход в каталог gentoo<br /> # cd /mnt/gentoo<br /> <br /> 5. Скачивание архива стадии<br /> # wget &lt;сервер&gt;/gentoo/releases/&lt;архитектура&gt;/current/stages/stage3-&lt;архитектура&gt;-2007.0.tar.bz2<br /> <br /> 6. Скачивание снимка дерева портежей<br /> # wget &lt;сервер&gt;/gentoo/snapshots/portage-latest.tar.bz2<br /> <br /> 7. Распаковка архива стадии<br /> # tar xvjpf stage3-i686-2007.0.tar.bz2<br /> <br /> 8. Распаковка снимка дерева портежей<br /> # tar xvjf /mnt/gentoo/portage-latest.tar.bz2 -C /mnt/gentoo/usr<br /> <br /> Файлы настройки<br /> <br /> 9. Правка одного из основных файлов Gentoo<br /> <br /> Файл: /mnt/gentoo/etc/make.conf<br /> <br /> # За подробностями см. make.conf.example<br /> CFLAGS="-O&lt;уровень_оптимизации&gt; -march=&lt;тип_ЦПУ&gt; -pipe"<br /> CXXFLAGS="${CFLAGS}"<br /> <br /> # Не изменять<br /> CHOST="&lt;архитектура&gt;"<br /> <br /> MAKEOPTS="-j&lt;кол-во_процессоров+1&gt;"<br /> GENTOO_MIRRORS=«<a href="http://distro.ibiblio.org/pub/linux/distributions/gentoo/">distro.ibiblio.org/pub/linux/distributions/gentoo/</a> „<br /> SYNC=“rsync://rsync.gentoo.org/gentoo-portage»<br /> <br /> # Для поддержки мыши и клавиатуры в Xorg<br /> INPUT_DEVICES=«keyboard mouse»<br /> # Для поддержки видеокарты в Xorg<br /> VIDEO_CARDS="&lt;название_драйвера&gt;"<br /> <br /> # См. /mnt/gentoo/usr/portage/profiles/use.desc<br /> # См. /mnt/gentoo/usr/portage/profiles/use.local.desc<br /> USE="&lt;флаги&gt;"<br /> <br /> 10. Настройка DNS<br /> <br /> Файл: /mnt/gentoo/etc/resolv.conf<br /> <br /> nameserver &lt;IP_сервера_DNS&gt;<br /> nameserver &lt;IP_ещё_одного_сервера_DNS&gt;<br /> Или просто скопировать текущую информацию о DNS-серверах<br /> # cp -L /etc/resolv.conf /mnt/gentoo/etc/resolv.conf<br /> <br /> 11. Информация о файловых системах<br /> <br /> Файл: /mnt/gentoo/etc/fstab<br /> <br /> /dev/sda1 / &lt;файловая_система&gt; defaults 0 1<br /> /dev/sda&lt;номер_раздела&gt; none swap sw 0 2<br /> /dev/sda&lt;номер_раздела&gt; &lt;каталог&gt; &lt;файловая_система&gt; defaults 0 2<br /> proc /proc proc defaults 0 0<br /> <br /> # Если /tmp нужен в ОЗУ<br /> none /tmp tmpfs defaults 0 0<br /> <br /> # Если CD/DVD монтируется вручную<br /> # Указанное для mod значение снимает флаг исполнения с файлов на CD/DVD<br /> /dev/hd/mnt/cdrom auto user,ro,noauto,uid=1000,gid=1000,mode=100644 0 0<br /> <br /> # Если планируется использование DVD-RAM<br /> /dev/hd/mnt/dvdram auto user,rw,noauto 0 0<br /> <br /> # Если флоппи кому-то ещё нужен<br /> /dev/fd0 /mnt/floppy auto user,iocharset=cp1251,noauto,rw,noexec,showexec 0 0<br /> <br /> 12. Имя машины<br /> <br /> Файл: /mnt/gentoo/etc/conf.d/hostname<br /> <br /> HOSTNAME="&lt;название_хоста&gt;"<br /> <br /> 13. Настройка сетевых параметров<br /> <br /> Файл: /mnt/gentoo/etc/conf.d/net<br /> <br /> # Задать параметры вручную…<br /> config_eth0=( " 192.168.0.1 netmask 255.255.255.0 broadcast 192.168.0.255" )<br /> routes_eth0=( «default gw 192.168.0.1» )<br /> <br /> #… или получить их автоматически<br /> config_eth0=( «dhcp» )<br /> dhcp_eth0=«nodns nontp nonis»<br /> Оживление Gentoo<br /> <br /> 14. Монтирование /proc<br /> # mount -t proc none /mnt/gentoo/proc<br /> <br /> 15. Монтирование /dev<br /> # mount -o bind /dev /mnt/gentoo/dev<br /> <br /> 16. Смена корневого каталога<br /> # chroot /mnt/gentoo /bin/bash<br /> <br /> ВАЖНО: Дальнейшие команды будут выполняться в среде Gentoo<br /> <br /> 17. Обновление переменных среды<br /> # env-update<br /> # source /etc/profile<br /> <br /> 18. Смена приглашения командной строки<br /> # export PS1="(chroot) $PS1"<br /> <br /> Сборка ядра<br /> <br /> 19. Обновление дерева портежей<br /> # emerge --sync<br /> или<br /> # emerge-webrsync<br /> <br /> 20. Установка исходных кодов ядра Gentoo<br /> # USE="-doc symlink" emerge gentoo-sources<br /> <br /> 21. Настройка ядра Gentoo<br /> # cd /usr/src/linux<br /> # make menuconfig<br /> <br /> ВАЖНО: Требует дополнительных действий (См. «Логика настройки ядра»)<br /> <br /> 22. Компиляция ядра<br /> # make &amp;&amp; make modules_install<br /> <br /> 23. Установка ядра<br /> # cp arch/i386/boot/bzImage /boot/linux-&lt;архитектура&gt;-gentoo<br /> <br /> Прочие системные установки<br /> <br /> 24. Сетевое подключение при загрузке системы<br /> # rc-update add net.eth0 default<br /> <br /> 25. Пароль суперпользователя<br /> # passwd<br /> <br /> 26. Система журналирования<br /> # emerge syslog-ng<br /> # rc-update add syslog-ng default<br /> <br /> 27. Периодические задания (по необходимости)<br /> # emerge vixie-cron<br /> # rc-update add vixie-cron default<br /> <br /> 28. Установка клиента DHCP (по необходимости)<br /> # emerge dhcpcd<br /> <br /> 29. Установка клиента PPPoE (по необходимости)<br /> # USE="-X" emerge rp-pppoe<br /> <br /> Настройка загрузчика<br /> <br /> 30. Установка загрузчика LILO<br /> # emerge lilo<br /> <br /> 31. Настройка LILO<br /> <br /> Файл: /etc/lilo.conf<br /> <br /> boot=/dev/sda<br /> prompt<br /> timeout=200<br /> default=gentoo<br /> <br /> image=/boot/linux-&lt;архитектура&gt;-gentoo<br /> label=gentoo<br /> read-only <br /> root=/dev/sda32. Записать LILO<br /> # /sbin/lilo<br /> <br /> Локализация в UNICODE<br /> <br /> 33. Установка шрифтов<br /> # emerge terminus-font intlfonts freefonts cronyx-fonts corefonts artwiz-fonts kbd<br /> <br /> 34. Включение нужных локалей<br /> <br /> Файл: /etc/locale.gen<br /> <br /> en_US ISO-8859-1<br /> en_US.UTF-8 UTF-8<br /> ru_RU.CP1251 CP1251<br /> ru_RU.KOI8-R KOI8-R<br /> ru_RU.UTF-8 UTF-8<br /> 35. Пересборка glibc<br /> # emerge -av glibc<br /> <br /> 36. Сборка локали<br /> # locale-gen<br /> <br /> 37. Переменные окружения<br /> <br /> Файл: /etc/env.d/02locale<br /> <br /> LC_ALL=""<br /> LANG=«ru_RU.UTF-8»<br /> LC_NUMERIC=«C»<br /> <br /> 38. Файл rc.conf<br /> <br /> Файл: /etc/rc.conf<br /> <br /> UNICODE=«yes»<br /> <br /> 39. Шрифт консоли<br /> <br /> Файл: /etc/conf.d/consolefont<br /> <br /> CONSOLEFONT=«Cyr_a8x16»<br /> <br /> 40. Карта<br /> <br /> Файл: /etc/conf.d/keymaps<br /> <br /> KEYMAP="-u ru4"<br /> SET_WINDOWKEYS=«yes»<br /> EXTENDED_KEYMAPS=""<br /> DUMPKEYS_CHARSET=«koi8-r»<br /> <br /> Загрузка Gentoo<br /> <br /> 41. Выход из окружения Gentoo<br /> # exit<br /> <br /> 42. Размонтирование разделов<br /> # cd /<br /> # umount /mnt/gentoo/&lt;путь&gt;<br /> и т.д.<br /> <br /> 43. Перезагрузка<br /> # reboot
