+++
title = "Wireshark для самых маленьких"
date = 2013-08-23T22:15:00Z
updated = 2013-08-23T22:16:47Z
tags = ["сеть", "для чайников", "wireshark"]
blogimport = true 
[author]
	name = "devi1"
	uri = "https://www.blogger.com/profile/05777499482649623616"
+++

<div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;">Меня всегда пугал этот инструмент. Пугал тем, что я НИЧЕГО не понимал в том, что он выводит. Я не понимал, как настраивать фильтры, не понимал, что вообще происходит и как это использовать. Мешал высокий порог вхождения. Когда-то такими же сложными для меня были Eclipse, IntelliJ IDEA, mercurial, maven ну и так далее. И чтобы преодолеть этот порог, обычно нужен хороший QuickStart – пятиминутный гайд, как включиться в работу. Без него всё идёт туго и невесело. Вот такой гайд я и хочу предложить.<br /><br /><a name='more'></a><br /></div><div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;">Итак, задача наша такая – посмотреть TCP-пакеты, идущие “на” или “с” заданного IP-адреса.</div><div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;">1. Включаем wireshark, выбираем сетевой интерфейс, который будем мониторить. Можно выбрать несколько интерфейсов. Выбираем тот, который используется для нашего сетевого взаимодействия. То есть например у вас программа обращается к серверу, который расположен в интернете, и несколько интерфейсов: один Ethernet, подключенный к интернету, другой – Wi-Fi для взаимодействия в рамках вашей локальной сети. Нас в этой ситуации будет интересовать Ethernet-адаптер. Его и выбираем. Нажимаем Start.</div><div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;">2. Пошли пакетики, их очень много, и нам нужно задать правила для фильтрации. Так как нас интересует TCP протокол, то мы можем использовать например следующее правило:</div><div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;"><code style="border: 0px; font-family: Monaco, Consolas, 'Andale Mono', 'DejaVu Sans Mono', monospace; line-height: normal; margin: 0px; outline: 0px; padding: 0px; vertical-align: baseline;">tcp &amp;&amp; (tcp.srcport == 80 || tcp.dstport == 80)</code></div><div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;">Первое условие отфильтровывает tcp-пакеты, второе – применяет дополнительные правила для порта.</div><div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;">Если нужно наложить условие на IP адреса, то это можно сделать так:&nbsp;<code style="border: 0px; font-family: Monaco, Consolas, 'Andale Mono', 'DejaVu Sans Mono', monospace; line-height: normal; margin: 0px; outline: 0px; padding: 0px; vertical-align: baseline;">ip.src_host == 87.31.220.35</code></div><div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;">3. Всё работает ! Достраивать правила для фильтрации несложно, поскольку есть автодополнение.</div><div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;">4. Если вы хотите перехватывать loopback-траффик (который идет через localhost), то тут, к сожалению, есть проблема. Дело в том, что этот траффик не доходит до сетевых адаптеров, и WireShark не в состоянии его перехватить. http://stackoverflow.com/questions/5847168/wireshark-localhost-traffic-capture Вот тут есть 2 решения этой проблемы: в первом случае предлагается установить Microsoft Loopback Adapter и натравить на него WireShark, во втором случае предлагается пошаманить с маршрутизацией. Судя по отзывам, оба способа работают, так что всё ок&nbsp;<img alt=":)" class="wp-smiley" src="http://elwood.su/wp-includes/images/smilies/icon_smile.gif" style="margin: 0.4em 0px 0px; padding: 0px;" /></div><div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;"><br /></div><div style="background-color: white; color: #333333; font-family: Georgia, 'Bitstream Charter', serif; font-size: 13px; line-height: 1.75; margin-bottom: 10px; padding: 0px;"><a href="http://elwood.su/?p=566">Отсюда</a>. Блоггеры, вы уж извините, что я копирую ваши статьи. Раньше просто ссылки оставлял, но сайты-оригиналы пропадают, переносятся, статьи удаляются, и мои ссылки остаются просто ссылками без смысловой нагрузки. Поэтому и копипижжю.</div>
