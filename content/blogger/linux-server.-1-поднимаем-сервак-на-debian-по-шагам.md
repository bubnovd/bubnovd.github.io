+++
title = "Linux Server. 1 Поднимаем сервак на Debian по шагам"
date = 2011-03-13T10:49:00Z
updated = 2012-09-02T23:21:00Z
tags = ["ssh", "putty", "firewall", "Linux Server", "iptables", "webmin", "MidnightCommander", "сеть", "для чайников", "debian"]
blogimport = true 
[author]
	name = "devi1"
	uri = "https://www.blogger.com/profile/05777499482649623616"
+++

Будем экспериментировать с Debian 6.0 Squeeze. Пост не рассматривается как руководство к действию - просто эксперименты с Debian'ом. Попробуем поднять все известные нужные/не очень сервисы. Постараюсь подробно и по шагам.<br />Вообще, если это будет первый опыт с UNIX-подобными системами, то рекомендую заюзать Ubuntu - она попроще и дружелюбней к новичкам. В Debian'е многое придется делать руками. А в целом руководство должно подойти и для Ubuntu.<br /><br /><br /><a name='more'></a>Сначала несколько самых важных команд:<br /><span class="Apple-style-span" style="color: cyan;">cd</span> - ходить по папкам (подняться на уровень выше cd ..),<span class="Apple-style-span" style="color: cyan;"> ls </span>- просмотреть содержимое папки, <span class="Apple-style-span" style="color: cyan;">nano</span> - удобный текстовый редактор,<span class="Apple-style-span" style="color: cyan;"> ps ax </span>- просмотреть все запущенные процессы, <span class="Apple-style-span" style="color: #cccccc;">apt</span>- утилита для работы с пакетами ПО (apt-get install packet - установка пакета(программы)).<br />Ещё нужно понять, что Линукс - не винда, и структура файловой системы здесь СОВСЕМ другая, хотя когда привыкаешь, понимаешь, что это достоинство Линукса. О файловой системе написано довольно много, поэтому не буду повторяться.<br /><br /><br /><b>1. Установка системы. </b>Ничего сверхсложного. Просто следуем рекомендациям установщика. Особо продвинутые могут вынести на разные диски разделы /home, /var, /usr и т.д. Из предложенных вариантов доп. софта отмечаем только стандартные утилиты, т.к. хочется сервисы поднимать ручками и увеличивать свои скиллы.<br /><br /><b>2. Настройка сети. </b>Так как у нас сервер, то в нем должно быть минимум 2 сетевых карточки =) Условимся, что eth1 "смотрит" в инет, а eth0 - в локалку. Да, в Линуксах сетевые интерфейсы называются именно так - eth0, eth1 и т.д. Ещё есть lo, ppp0, но об этом позже.<br />Настройка сети сводится к редактированию файла <span class="Apple-style-span" style="color: cyan;">/etc/network/interfaces</span> . Проще всего это сделать с помощью редактора nano. Делать все нужно с правами суперпользователя, для этого нужно набрать su и ввести пароль, заданный на этапе установки. Набираем в терминале nano /etc/network/interfaces и прописываем настройки. Там уже должны быть строки вроде:<br /><br /><br /><span class="Apple-style-span" style="background-color: #274e13;"># This file describes the network interfaces available on your system</span><br /><span class="Apple-style-span" style="background-color: #274e13;"># and how to activate them. For more information, see interfaces(5).</span><br /><span class="Apple-style-span" style="background-color: #274e13;"><br /></span><br /><span class="Apple-style-span" style="background-color: #274e13;"># The loopback network interface</span><br /><span class="Apple-style-span" style="background-color: #274e13;">auto lo</span><br /><span class="Apple-style-span" style="background-color: #274e13;">iface lo inet loopback</span><br /><div><br /></div><div>Всё, что идет после знака # - комментарии, они игнорируются системой. lo - это петля, чтобы система могла видеть себя по адресам 127.0.0.1 и localhost. Больше об этом ничего не скажу - сам толком не знаю.</div><div>Следующими строками добавляем примерно следующее:</div><div><div><span class="Apple-style-span" style="background-color: #274e13;">auto eth0</span></div><div><span class="Apple-style-span" style="background-color: #274e13;">iface eth0 inet static</span></div><div><span class="Apple-style-span" style="background-color: #274e13;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;address 192.168.0.100</span></div><div><span class="Apple-style-span" style="background-color: #274e13;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;netmask 255.255.255.0</span></div><div><span class="Apple-style-span" style="background-color: #274e13;"><br /></span></div><div><span class="Apple-style-span" style="background-color: #274e13;"><br /></span></div><div><span class="Apple-style-span" style="background-color: #274e13;">auto eth1</span></div><div><span class="Apple-style-span" style="background-color: #274e13;">iface eth1 inet static</span></div><div><span class="Apple-style-span" style="background-color: #274e13;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;address 192.168.44.223</span></div><div><span class="Apple-style-span" style="background-color: #274e13;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;netmask 255.255.255.0</span></div><div><span class="Apple-style-span" style="background-color: #274e13;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;gateway 192.168.44.1</span></div></div><div><br /></div><div>Думаю, здесь всё ясно - address - это наш IP-адрес, netmask - маска, gateway - шлюз. static - поясняет системе, что адрес присваивается статично. Если у вас dhcp, то вместо statiс нужно написать dhcp. Ну естественно циферки нужно вбить свои =) В винде нам бы пришлось ребутиться, но у нас же линукс - тут можно перезапустить сетевую подсистему без перезагрузки - /etc/init.d/networking restart Но можно и ребутнуться reboot</div><div>Адреса DNS-серверов прописаны в файле /etc/resolv.conf Если у вас его нет просто создайте его: <span class="Apple-style-span" style="color: cyan;">nano /etc/resolv.conf </span>и пропишите сервера в виде:&nbsp;</div><div><span class="Apple-style-span" style="background-color: #274e13;">nameserver xxx.xxx.xxx.xxx</span></div><div><span class="Apple-style-span" style="background-color: #274e13;">nameserver xxx.xxx.xxx.xxx</span></div><div><br /></div><div><b>3. Поднимаем инет. </b>У многих провайдеров интернет раздается посредством vpn-соединения. Чтобы получить сию благодать придется попариться =) Нужно узнать у провайдера настройки для UNIX-подобных систем. Мне пришлось сделать следующее:</div><div>3.1. Установить<span class="Apple-style-span" style="color: cyan;"> pptpclient</span>. Его можно найти на диске с дистрибутивом.</div><div>3.2. Настроить маршрутизацию:</div><div><span class="Apple-style-span" style="color: cyan;">route del default</span></div><div><span class="Apple-style-span" style="color: cyan;">route add -net xxx.xxx.xxx.xxx netmask 255.255.255.0 gw xxx.xxx.xxx.xxx eth1</span></div><div>Здесь xxx.xxx.xxx.xxx - адрес, предложенный провайдером.</div><div>3.3. Настроить pp<span class="Apple-style-span" style="font-family: inherit;">tp - клиента как предлагает</span> провайдер. Файл /etc/ppp/options:</div><div><span class="Apple-style-span" style="color: white;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">local</span><span class="Apple-style-span" style="background-color: #274e13;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">lock</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">nodetach</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">mtu 1512</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">mru 1512</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">require-mppe-40</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">require-mppe-128</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">require-mppe</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">lcp-echo-interval 30</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">lcp-echo-failure 5</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">require-mschap-v2</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">refuse-pap</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">refuse-chap</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">refuse-mschap</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">refuse-eap</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">defaultroute</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">user ВАШ_ЛОГИН</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;">noauth</span></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-size: 12px; line-height: 15px;"><br /></span></span></div><div><span class="Apple-style-span" style="color: white;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="font-family: inherit;">Файл /etc/ppp/chap-secrets:</span><span class="Apple-style-span" style="font-family: Times, 'Times New Roman', serif;">&nbsp;</span></span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; font-family: Times, 'Times New Roman', serif; line-height: 15px;">ВАШ_ЛОГИН * ВАШ_ПАРОЛЬ *</span></span></div><div><span class="Apple-style-span" style="color: white; font-family: inherit;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;">Поменять права на chap-secrets:&nbsp;</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;">chmod 400 chap-secrets</span></span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;">3.4. Набрать в терминале pptp vpn.server.ru и всё заработало.</span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;">3.5. Будем надеяться, что у вас тоже всё получилось. Тогда можно написать скрипт для автоподнятия инета или перейти к обновлению.&nbsp;</span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">Чтобы инет поднимался автоматически после старта системы нужно все команды для поднятия инета завернуть в скрипт.</span><span class="Apple-style-span" style="color: cyan; font-family: Times, 'Times New Roman', serif;"> nano /usr/local/bin/pptp-run.sh</span></span></div><div><span class="Apple-style-span" style="font-family: Times, 'Times New Roman', serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; line-height: 15px;">#!/bin/bash&nbsp;</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">route del default &nbsp; &nbsp; &nbsp;#первая команда из п. 3.2</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">#вторая команда и т.д.</span></span></div><div><span class="Apple-style-span" style="background-color: #274e13; font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-size: 12px; line-height: 15px;"></span></span><br /><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">LOG="/var/log/pptp-run.log"</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">while true; do</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;echo -e "\n=========================================\n `date`" &gt;&gt; $LOG</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/usr/sbin/pptp vpn.server.ru &gt;&gt; $LOG</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;sleep 10;</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">done</span></span></div></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15px;"><br /></span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;">Как видно из скрипта, он логирует свою работу, а значит можно увидеть как отработал скрипт в файле /var/log/pptp-run.log Теперь нужно дать скрипту права на выполнение, потому что сейчас система видит его как простой текстовый файл: </span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: cyan; font-family: inherit; line-height: 15px;">chmod +x pptp-run.sh</span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;">Осталось прописать скриптик в автозагрузку.</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: cyan; font-family: inherit; line-height: 15px;"> nano /etc/rc.loca</span><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;">l</span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; line-height: 15px;"><span class="Apple-style-span" style="font-family: inherit;">Перед строкой exit 0 пишем путь до скрипта:</span><span class="Apple-style-span" style="background-color: #274e13;"><span class="Apple-style-span" style="font-family: inherit;"> </span><span class="Apple-style-span" style="font-family: Times, 'Times New Roman', serif;">/usr/local/bin/pptp-run.sh</span></span></span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;"><br /></span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;"><b>4. Обновляем систему.</b> Обновления выкачиваются из репозитариев, по умолчанию они не прописаны в системе.</span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">4.1. &nbsp;Поэтому нужно их прописать.</span><span class="Apple-style-span" style="font-family: Times, 'Times New Roman', serif;"> <span class="Apple-style-span" style="color: cyan;">nano /etc/apt/sources.list</span></span></span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;">Если не собираемся ничего ставить с диска, то закомментируем строки</span></div><div><span class="Apple-style-span" style="color: white; font-family: Times, 'Times New Roman', serif;"></span><br /><div><span class="Apple-style-span" style="font-family: Times, 'Times New Roman', serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; line-height: 15px;">&nbsp;<span class="Apple-style-span" style="background-color: #274e13;">deb cdrom:[Debian GNU/Linux 6.0.0 _Squeeze_ - Official i386 CD Binary-1 20110205-17:27]/ squeeze main</span></span></span></div><div><span class="Apple-style-span" style="font-family: Times, 'Times New Roman', serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; line-height: 15px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Times, 'Times New Roman', serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; line-height: 15px;">deb cdrom:[Debian GNU/Linux 6.0.0 _Squeeze_ - Official i386 CD Binary-1 20110205-17:27]/ squeeze main</span></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;"><br /></span></div></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;">Также нужно добавить репозитарии:</span></div><div><div style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">#Offical Debian repository</span></div><div style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">deb http://ftp.debian.org/debian/ squeeze main non-free contrib</span></div><div style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">deb-src http://ftp.debian.org/debian/ squeeze main non-free contrib</span></div><div style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;"><br /></span></div><div style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">#Official Debian repository Russian mirrors</span></div><div style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">deb http://ftp.ru.debian.org/debian/ squeeze main non-free contrib</span></div><div style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; background-color: #274e13; color: white; font-size: 12px; line-height: 15px;">deb-src http://ftp.ru.debian.org/debian/ squeeze main non-free contrib</span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; font-size: 12px; line-height: 15px;"><br /></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">4.2. Обновляем списки репозитариев: apt-get update</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">4.3. Обновляем систему: apt-get upgrade</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">Теперь можно заняться работой =))</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;"><br /></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;"><b>5. Установка софта первой необходимости.</b>&nbsp;</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">5.1. Чтобы можно было удаленно работать с сервом нужен ssh-сервер.</span><span class="Apple-style-span" style="color: cyan; font-family: inherit;">apt-get install openssh-server </span><span class="Apple-style-span" style="color: white; font-family: inherit;">Теперь можно работать с серваком с любого другого компа, подключенного к сети через ssh-клиент. В винде это PuTTY.</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">5.2. Если боитесь командной строки, рекомендую поставить файловый менеджер mc (Midnight Commander - аналог виндового Norton Commaner, FAR и т.д.). </span><span class="Apple-style-span" style="color: cyan; font-family: inherit;">apt-get install mc </span><span class="Apple-style-span" style="color: white; font-family: inherit;">Запускается установленный ФМ командой mc</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">5.3. Работать в системе с правами суперпользователя (su) небезопасно. Можно поставить sudo. Она позволяет не входить в систему под суперюзером, а единожды выполнять команду с его правами, например sudo apt-get install. Как ставить софт думаю уже понятно, поэтому больше не буду повторяться (su; apt-get install имя_пакета). Без небольшой настройки sudo не заработает. Нужно подредактировать файлик /etc/sudoers (как редактировать надеюсь тоже ясно: su; nano имя_файла; Ctrl+X; Y). Добавляем строку:</span></div><div><span class="Apple-style-span" style="color: white; font-family: inherit;"></span><br /><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; line-height: 15px;"><span class="Apple-style-span" style="font-family: inherit;">имя_пользователя &nbsp; </span><span class="Apple-style-span" style="background-color: #274e13; font-family: Times, 'Times New Roman', serif;">ALL=(ALL) ALL</span></span><br /><span style="color: white; font-family: Times, Times New Roman, serif;"><span style="line-height: 15px;">Можно сделать ещё проще: добавить нужного юзера в группу sudo: usermod</span></span><span style="color: white; font-family: Times, 'Times New Roman', serif; line-height: 15px;">username</span>&nbsp;<span style="color: white; font-family: Times, Times New Roman, serif;"><span style="line-height: 15px;">-aG &nbsp;sudo</span></span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;">5.4. Для тех, у кого фобия командной строки рекомендую копать в сторону webmin. Но это не наш путь - с ним вы толком ничего не поймете, а лишь будете знать что можно сделать с линухом. Для экспериментов да похвастаться перед одноклассниками (превед школота!) что "Я паставил Линух!" сойдет, но не больше!</span></div><div><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; color: white; font-family: inherit; line-height: 15px;">5.5. Продвинутый диспетчер процессов - htop</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;"><br /></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;"><b>6. Настройка простейшего роутера.</b></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">Наш роутер будет передавать весь траффик с интернета в локальную сеть и обратно. Для этого нужно использовать NAT. Проптсываем в настройках фаервола натинг:</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: cyan; font-family: inherit;">iptables -t nat -A POSTROUTING -o eth1 -j MASQUERAD</span><span class="Apple-style-span" style="color: cyan; font-family: inherit;">E</span><br /><span class="Apple-style-span" style="background-color: black; color: white;">Но это ещё не всё. Для работы натинга необходимо разрешить пересылку пакетов в ядре. В файле /etc/sysctl.conf нужно раскомментировать строку</span><span class="Apple-style-span" style="color: cyan;">&nbsp;</span><span class="Apple-style-span" style="background-color: #274e13; color: white;">net.ipv4.ip_forward=1</span><span class="Apple-style-span" style="color: cyan;"> .</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">После перезагрузки настройки фаервола сбросятся, поэтому следует сохранить цепочки фаера:</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: cyan; font-family: inherit;">iptables-save &gt; /etc/iptables-save</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">И прописать восстановление этих настроек при загрузке системы. В файл /etc/network/interfaces </span><span class="Apple-style-span" style="color: white; font-family: Times, 'Times New Roman', serif;">добавить строку:</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="font-family: Times, 'Times New Roman', serif;"><span class="Apple-style-span" style="background-color: #274e13; color: white;">up iptables-restore &lt; /etc/iptables-save</span></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: Times, 'Times New Roman', serif;"><br /></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="color: white; font-family: inherit;">К<span class="Apple-style-span" style="background-color: black;">онечно это простейший роутер, без ограничения траффика, проверки на вирусы и прочего, но он работает =)</span></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: Times, 'Times New Roman', serif;"><br /></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: Times, 'Times New Roman', serif;"><br /></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: Times, 'Times New Roman', serif;"><b><br /></b></span><br /><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;"><b>7. Настройка Wi-Fi </b></span><br /><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">Скомпилировано из этого:</span><br /><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">1.&nbsp;<a href="http://bagow.org/nastrojka-wi-fi-v-debian/">http://bagow.org/nastrojka-wi-fi-v-debian/</a></span><br /><span class="Apple-style-span" style="background-color: black; font-family: inherit;">2.&nbsp;<a href="http://gettoknowlinux.blogspot.com/2010/07/wifi-access-point-debian-atheros.html">http://gettoknowlinux.blogspot.com/2010/07/wifi-access-point-debian-atheros.htm</a></span><br /><span class="Apple-style-span" style="background-color: black; font-family: inherit;">3.&nbsp;<a href="http://sudouser.com/linux-v-roli-wi-fi-tochki-dostupa.html">http://sudouser.com/linux-v-roli-wi-fi-tochki-dostupa.html</a></span><br /><span class="Apple-style-span" style="font-family: inherit;"><span class="Apple-style-span" style="background-color: black;"><a href="http://sudouser.com/linux-v-roli-wi-fi-tochki-dostupa.html"></a>4.&nbsp;</span><a href="http://forum.ubuntu.ru/index.php?topic=61834.0">http://forum.ubuntu.ru/index.php?topic=61834.0</a></span><br /><a href="http://gettoknowlinux.blogspot.com/2010/07/wifi-access-point-debian-atheros.html"><span class="Apple-style-span" style="font-family: inherit;">l</span></a><br /><span class="Apple-style-span" style="color: white;"><span style="background-color: black; font-family: inherit;">Можно &nbsp;сделать наш серв точкой доступа и раздавать инет на мобильные устройства. Для этого нужна беспроводная сетевая карточка. Нужно узнать её производителя и, желательно, чип, на котором она работает. У меня была сетевушка D-Link DWA-510 (RaLink RT2561/RT61). Чип можно узнать на сайте производителя или у гугла на крайняк.&nbsp;</span></span><br /><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">Моя сетевушка &nbsp;без проблем определилась системой</span><span class="Apple-style-span" style="background-color: black; color: white; font-family: Times, 'Times New Roman', serif;">.</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: Times, 'Times New Roman', serif;"><br /></span><br /><span class="Apple-style-span" style="background-color: black; color: white; font-family: Times, 'Times New Roman', serif;">Чёт поздно уже... Продолжение следует....... </span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: Times, 'Times New Roman', serif;"><br /></span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">===================================================================</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">На этом пока всё. Скоро будем копать дальше. В планах:</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">1. Правильная настройка iptables.</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">2. Настройка файл-сервера с разными уровнями доступа.</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">3. Квотирование диска.</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">4. Настройка контроллера домена.</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">5. Настройка dhcp-сервера.</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">6. Настройка прокси-сервера. И различных плюшек для него (статистика, баннерорезалка, антивирус, прозрачность).</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">7. Настройка Asterisk (IP-телефония).</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="background-color: black; color: white; font-family: inherit;">8. Настройка LAMP (Linux, Apache, MySQL, PHP).</span></div><div style="-webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: 15px;"><span class="Apple-style-span" style="font-family: Times, 'Times New Roman', serif;"><br /></span></div></div></div>
