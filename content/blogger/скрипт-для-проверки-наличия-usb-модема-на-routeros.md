+++
title = "Скрипт для проверки наличия USB-модема на RouterOS"
date = 2015-03-01T20:42:00Z
updated = 2015-03-01T20:42:36Z
tags = ["routeros", "Mikrotik", "script", "Автоматизация", "скрипт"]
blogimport = true 
[author]
	name = "devi1"
	uri = "https://www.blogger.com/profile/05777499482649623616"
+++

Понадобился скрипт, определяющий наличие USB-модема, подключенного к Mikrotik. Присылает на почту название модема и его серийник. Хорошо бы допилить скрипт до отправки уровня сигнала и количества денег на счете, но мои модемы не дают доступа к своему меню - надо шить.<br /><br /><a name='more'></a><br /><br /><span style="font-family: Courier New, Courier, monospace;">:log info "Starting Modem Info Script...";</span><br /><span style="font-family: Courier New, Courier, monospace;">:local sysname [/system identity get name];</span><br /><span style="font-family: Courier New, Courier, monospace;">:local sysver [/system package get system version];</span><br /><span style="font-family: Courier New, Courier, monospace;">:local mname [/system resource usb get 1 value-name=name];</span><br /><span style="font-family: Courier New, Courier, monospace;">:local mnumber [/system resource usb get 1 value-name=serial-number];</span><br /><span style="font-family: Courier New, Courier, monospace;">:local smtpserv [:resolve "smtp.mail.ru"];</span><br /><span style="font-family: Courier New, Courier, monospace;">:local Eaccount "mail@mail.ru";</span><br /><span style="font-family: Courier New, Courier, monospace;">:local pass "your_password";</span><br /><span style="font-family: Courier New, Courier, monospace;">:log info "Collecting Information";</span><br /><span style="font-family: Courier New, Courier, monospace;">:delay 5;</span><br /><span style="font-family: Courier New, Courier, monospace;">:log info "Sending Information via E-mail...";</span><br /><span style="font-family: Courier New, Courier, monospace;">/tool e-mail send from="&lt;$Eaccount&gt;" to=$Eaccount server=$smtpserv \</span><br /><span style="font-family: Courier New, Courier, monospace;">port=587 user=$Eaccount password=$pass start-tls=yes \</span><br /><span style="font-family: Courier New, Courier, monospace;">subject=("$sysname Modem Information (" . [/system clock get date] . ")") \</span><br /><span style="font-family: Courier New, Courier, monospace;">body=("$sysname Modem.\nTime and Date stamp: " . [/system clock get time] . " " . \</span><br /><span style="font-family: Courier New, Courier, monospace;">[/system clock get date] . "\nModem $mname, SN: $mnumber");</span><br /><span style="font-family: Courier New, Courier, monospace;">:log info "Modem Info Complete!";</span><br /><br /><br />
