+++
title = "Переустановка стека TCP/IP в Windows XP"
date = 2011-02-25T06:26:00Z
updated = 2011-02-25T06:43:53Z
blogimport = true 
[author]
	name = "devi1"
	uri = "https://www.blogger.com/profile/05777499482649623616"
+++

<span class="Apple-style-span" style="font-family: sans-serif; font-size: 13px; line-height: 19px;"></span><br /><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Иногда бывает так, что сетевые настройки в норме, сетевая карта работает, сетевые службы запущены, а сети всё равно нет. Естественно такое может быть только в Мастдайке =) Выход можно найти в следующих строчках... И да, не забудьте проверить систему свеженьким антивирусным сканером, перед этими действиями и создать точку восстановления.<br /><br /><a name='more'></a><br /><br /><a class="external free" href="http://support.microsoft.com/kb/299357/ru" rel="nofollow" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: url(http://wiki.mag-soft.ru/skins/vector/images/external-link-ltr-icon.png); background-origin: initial; background-position: 100% 50%; background-repeat: no-repeat no-repeat; color: #3366bb; padding-bottom: 0px; padding-left: 0px; padding-right: 13px; padding-top: 0px; text-decoration: none;">http://support.microsoft.com/kb/299357/ru</a></div><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Для начала есть способ который позволяет мягко сбросить текущее состояние библиотеки WinSock в начальные "чистые" настройки. Делается это командой netsh winsock reset.</div><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Если первый способ не помог, то дальше надо сбросить конфигурацию интерфейсов IP. Делается это командой netsh int ip reset c:\resetlog.txt</div><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Ещё есть замечательная программа <a href="http://winsockfix.nl/">WinsockFix</a>,&nbsp;она приводит стек TCP/IP к стандартным установкам (как на "чистой системе").</div><div style="line-height: 1.5em; margin-bottom: 0.5em; margin-left: 0px; margin-right: 0px; margin-top: 0.4em;">Если и это не помогло, полностью переустановить стек TCP/IP можно так:</div><ol style="line-height: 1.5em; list-style-image: none; margin-bottom: 0px; margin-left: 3.2em; margin-right: 0px; margin-top: 0.3em; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><li style="margin-bottom: 0.1em;">Удалите раздел реестра командой REG DELETE HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Winsock</li><li style="margin-bottom: 0.1em;">Удалите раздел реестра командой REG DELETE HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Winsock2</li><li style="margin-bottom: 0.1em;">Перезагрузите компьютер</li><li style="margin-bottom: 0.1em;">Откройте папку&nbsp;%winroot%\inf</li><li style="margin-bottom: 0.1em;">В ней найтите файл nettcpip.inf, сделайте его резервную копию и после откройте его в текстовом редакторе (например Notepad).</li><li style="margin-bottom: 0.1em;">Найдите в нем строки:<br />[MS_TCPIP.PrimaryInstall]<br />; TCPIP has properties to display<br />Characteristics = 0xA0 ; NCF_HAS_UI | NCF_NOT_USER_REMOVABLE</li><li style="margin-bottom: 0.1em;">Исправить их на:<br />[MS_TCPIP.PrimaryInstall]<br />; TCPIP has properties to display<br />Characteristics = 0x80 ; NCF_HAS_UI</li><li style="margin-bottom: 0.1em;">Сохранить изменения в файле nettcpip.inf</li><li style="margin-bottom: 0.1em;">Открыть Network Connections и щелкнув правой кнопкой мыши по свойству нужного нам сетевого подключения выбрать Install-&gt;Protocol-&gt;Add. Далее выбрать "have disk" и указать путь&nbsp;%winroot%\inf</li><li style="margin-bottom: 0.1em;">Выбрать TCP/IP из списка. После этого вы опять попадете в окно свойств сетевого подключения, но для TCP/IP теперь кнопка Uninstall будет активна.</li><li style="margin-bottom: 0.1em;">Выберите в списке This connection uses the following items протокол TCP/IP и нажмите кнопку Uninstall.</li><li style="margin-bottom: 0.1em;">Перезагрузите компьютер</li><li style="margin-bottom: 0.1em;">Установить протокол TCP/IP аналогично шагам 9-12.</li></ol><div><span class="Apple-style-span" style="line-height: 24px;"><br /></span></div><div><span class="Apple-style-span" style="line-height: 24px;">У меня была такая история: сетевая рабочая, вирусов нет... Сети тоже =) За день до происшествия винда поставила несколько пакетов обновления и Касперский убил пару вирусов. Теперь сети нет не только в ОС, но и с LiveCD (Windows, Linux). При попытке ipconfig пишет "Произошла внутренняя ошибка: такой запрос не поддерживается. Не удалось запросить имя узла". ARP-записи девственно чистые. Ставил другую сетевушку, грузился с ней в локальную ОС и лайв си-ди. Естественно проделывал все вышеописанные танцы в присутствии бубна. Ни-че-го. Что это? Жду ответов</span></div>
